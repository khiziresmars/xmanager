# ะะณะตะฝั ะะฐััะตัะฐ ะบะปััะตะน - ะฃะฟัะฐะฒะปะตะฝะธะต 3x-ui

ะกะพะฒัะตะผะตะฝะฝัะน ะฒะตะฑ-ะธะฝัะตััะตะนั ะธ REST API ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ 3x-ui ะฟะฐะฝะตะปะธ.

**โ ะะฐะฑะพัะฐะตั ั ะปัะฑะพะน ะฒะตััะธะตะน 3x-ui** - ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพะฟัะตะดะตะปัะตั ััะตะผั ะฑะฐะทั ะดะฐะฝะฝัั

---

## โก ะััััะฐั ัััะฐะฝะพะฒะบะฐ

```bash
# ะะปะพะฝะธััะนัะต ัะตะฟะพะทะธัะพัะธะน
git clone https://github.com/khiziresmars/xmanager.git
cd xmanager

# ะะฐะฟัััะธัะต ัััะฐะฝะพะฒะบั
sudo bash install.sh
```

**ะะพัะพะฒะพ!** ะกะบัะธะฟั ะฐะฒัะพะผะฐัะธัะตัะบะธ:
- โ ะกะพะทะดะฐัั ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต Python
- โ ะฃััะฐะฝะพะฒะธั ะฒัะต ะทะฐะฒะธัะธะผะพััะธ
- โ ะะฐัััะพะธั systemd ัะตัะฒะธั
- โ ะะฝัะตะณัะธััะตััั ั Nginx
- โ ะะพะปััะธั SSL ัะตััะธัะธะบะฐั Let's Encrypt

**ะขัะตะฑะพะฒะฐะฝะธั:**
- OS: Debian 11+, Ubuntu 20.04+
- Python 3.8+
- 3x-ui (ะปัะฑะฐั ะฒะตััะธั)
- Root ะดะพัััะฟ

**ะะพัะปะต ัััะฐะฝะพะฒะบะธ:** `https://ะฒะฐั-ะดะพะผะตะฝ/manager/`

---

## ๐ฏ ะัะฝะพะฒะฝัะต ะฒะพะทะผะพะถะฝะพััะธ

### ๐ ะััะตะฝัะธัะธะบะฐัะธั
- ะัะพะด ั ะฟะฐัะพะปะตะผ (login: `esmarsme`, password: `EsmarsMe13AMS1`)
- API ัะพะบะตะฝั ะดะปั ะฟัะพะณัะฐะผะผะฝะพะณะพ ะดะพัััะฟะฐ
- ะกะตััะธะธ ั ัะฐะนะผะฐััะพะผ 24 ัะฐัะฐ

### ๐ฅ ะฃะฟัะฐะฒะปะตะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ
- ะกะพะทะดะฐะฝะธะต ะดะพ 5000 ะฟะพะปัะทะพะฒะฐัะตะปะตะน ัะตัะตะท ัะธััะตะผั ะพัะตัะตะดะตะน
- ะะฐััะพะฒัะต ะพะฟะตัะฐัะธะธ (ัะพะทะดะฐะฝะธะต, ัะดะฐะปะตะฝะธะต, ะฑะปะพะบะธัะพะฒะบะฐ)
- ะะพะดะดะตัะถะบะฐ VLESS, Trojan, VMess, Shadowsocks
- ะะพะธัะบ ะฟะพ email, ัะธะปัััะฐัะธั ะฟะพ inbound
- ะฃะฟัะฐะฒะปะตะฝะธะต ััะฐัะธะบะพะผ ะธ ััะพะบะฐะผะธ

### ๐ ะะพะฝะธัะพัะธะฝะณ
- ะะฝะปะฐะนะฝ ะฟะพะปัะทะพะฒะฐัะตะปะธ
- ะะฐะณััะทะบะฐ CPU/ะฟะฐะผััะธ/ะดะธัะบะฐ
- ะกะตัะตะฒะฐั ััะฐัะธััะธะบะฐ
- ะัะตะผั ัะฐะฑะพัั ัะตัะฒะตัะฐ
- ะะฒัะพะพะฑะฝะพะฒะปะตะฝะธะต ะบะฐะถะดัะต 5 ัะตะบัะฝะด

### โก ะัะตัะตะดะธ
- ะกะพะทะดะฐะฝะธะต ะดะพ 5000 ะฟะพะปัะทะพะฒะฐัะตะปะตะน
- ะะฑัะฐะฑะพัะบะฐ ะฑะฐััะฐะผะธ ะฟะพ 100
- ะััะปะตะถะธะฒะฐะฝะธะต ะฟัะพะณัะตััะฐ
- ะัะผะตะฝะฐ ะฒ ะฟัะพัะตััะต

### ๐ API ะขะพะบะตะฝั
- ะะตะฝะตัะฐัะธั ะดะปั ะฟัะพะณัะฐะผะผะฝะพะณะพ ะดะพัััะฟะฐ
- ะัะทัะฒ/ัะดะฐะปะตะฝะธะต ัะพะบะตะฝะพะฒ
- ะััะปะตะถะธะฒะฐะฝะธะต ะธัะฟะพะปัะทะพะฒะฐะฝะธั
- Bearer token auth

---

## ๐ API ะัะฝะพะฒะฝัะต endpoints

### ะััะตะฝัะธัะธะบะฐัะธั
```bash
POST /api/auth/login
POST /api/auth/logout
POST /api/tokens/generate
```

### ะะพะปัะทะพะฒะฐัะตะปะธ
```bash
GET  /api/users                # ะกะฟะธัะพะบ ะฟะพะปัะทะพะฒะฐัะตะปะตะน
POST /api/users                # ะกะพะทะดะฐัั ะฟะพะปัะทะพะฒะฐัะตะปั
DELETE /api/users/{id}         # ะฃะดะฐะปะธัั ะฟะพะปัะทะพะฒะฐัะตะปั
POST /api/users/bulk-create    # ะะพ 100 ะฟะพะปัะทะพะฒะฐัะตะปะตะน
POST /api/queues/bulk-create   # ะะพ 5000 ัะตัะตะท ะพัะตัะตะดะธ
```

### ะขัะฐัะธะบ
```bash
GET  /api/users/unlimited      # ะะตะทะปะธะผะธัะฝัะต ะฟะพะปัะทะพะฒะฐัะตะปะธ
GET  /api/users/low-traffic    # ะะธะทะบะธะน ััะฐัะธะบ
POST /api/users/reset-traffic  # ะกะฑัะพัะธัั ััะฐัะธะบ
POST /api/users/add-traffic    # ะะพะฑะฐะฒะธัั ััะฐัะธะบ
POST /api/users/set-limit      # ะฃััะฐะฝะพะฒะธัั ะปะธะผะธั
```

### ะฃะฟัะฐะฒะปะตะฝะธะต
```bash
POST /api/users/toggle-status  # ะะปะพะบะธัะพะฒะบะฐ/ัะฐะทะฑะปะพะบะธัะพะฒะบะฐ
POST /api/users/extend-expiry  # ะัะพะดะปะตะฝะธะต ััะพะบะฐ
PUT  /api/users/{id}/expiry    # ะฃััะฐะฝะพะฒะบะฐ ััะพะบะฐ (expiry_time ะฒ ะผั)
PUT  /api/users/{id}/traffic   # ะฃััะฐะฝะพะฒะบะฐ ะปะธะผะธัะฐ ััะฐัะธะบะฐ
```

### ะกะธะฝััะพะฝะธะทะฐัะธั ะฟะพะดะฟะธัะพะบ (v1.4.0)
```bash
GET  /api/users/by-email/{email}     # ะะพะธัะบ ะฟะพ email
POST /api/users/set-expiry           # ะะฐััะพะฒะฐั ัััะฐะฝะพะฒะบะฐ ััะพะบะฐ
GET  /api/analytics/expiry-status    # ะกัะฐัะธััะธะบะฐ ะฟะพ ััะพะบะฐะผ
POST /api/sync/from-external         # ะกะธะฝััะพะฝะธะทะฐัะธั ั ะฒะฝะตัะฝะตะน ัะธััะตะผะพะน
```

#### ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

**ะฃััะฐะฝะพะฒะบะฐ ััะพะบะฐ ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปั:**
```bash
curl -X PUT "https://server/manager/api/users/123/expiry" \
  -H "Content-Type: application/json" \
  -d '{"expiry_time": 1735689599000}'
```

**ะะฐััะพะฒะฐั ัะธะฝััะพะฝะธะทะฐัะธั:**
```bash
curl -X POST "https://server/manager/api/sync/from-external" \
  -H "Content-Type: application/json" \
  -d '{
    "users": [
      {"email": "user@vless", "expiry_time": 1735689599000, "traffic_limit": 161061273600}
    ]
  }'
```

**ะกัะฐัะธััะธะบะฐ ะฟะพ ััะพะบะฐะผ:**
```bash
curl "https://server/manager/api/analytics/expiry-status"
# ะะพะทะฒัะฐัะฐะตั: total_users, expired, expiring_soon, active, unlimited
```

### ะะพะฝะธัะพัะธะฝะณ
```bash
GET /api/stats                  # ะกัะฐัะธััะธะบะฐ ัะธััะตะผั
GET /api/monitoring/health      # ะกะพััะพัะฝะธะต ัะตัะฒะตัะฐ
GET /api/monitoring/online-users # ะะฝะปะฐะนะฝ ะฟะพะปัะทะพะฒะฐัะตะปะตะน
```

### ะัะตัะตะดะธ
```bash
GET    /api/queues             # ะกะฟะธัะพะบ ะพัะตัะตะดะตะน
GET    /api/queues/{id}        # ะกัะฐััั ะพัะตัะตะดะธ
POST   /api/queues/{id}/cancel # ะัะผะตะฝะธัั ะพัะตัะตะดั
DELETE /api/queues/{id}        # ะฃะดะฐะปะธัั ะพัะตัะตะดั
```

### ะกะธััะตะผะฐ
```bash
GET /api/health                # Health check
GET /api/server/info           # ะะฝัะพัะผะฐัะธั ะพ ัะตัะฒะตัะต
GET /api/inbounds              # ะกะฟะธัะพะบ inbounds
```

**ะะฝัะตัะฐะบัะธะฒะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั:** `/api/docs`

---

## ๐ง ะฃะฟัะฐะฒะปะตะฝะธะต ัะตัะฒะธัะพะผ

```bash
# ะกัะฐััั
systemctl status xui-manager

# ะะตัะตะทะฐะฟััะบ
systemctl restart xui-manager

# ะะพะณะธ
journalctl -u xui-manager -f
tail -f /var/log/xui-manager.log

# ะัะพะฒะตัะบะฐ API
curl http://localhost:8888/api/health
```

---

## ๐๏ธ ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ        NGINX (HTTPS:443)             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  /manager/  โ API (8888)             โ
โ  /esmars/   โ X-UI (2096)            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  FastAPI + SQLite                    โ
โ  /etc/x-ui/x-ui.db                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ะะตะทะพะฟะฐัะฝะพััั

1. **ะกะผะตะฝะธัะต ะดะตัะพะปัะฝัะต ะฟะฐัะพะปะธ** ะฟะพัะปะต ัััะฐะฝะพะฒะบะธ
2. **ะัะฟะพะปัะทัะนัะต HTTPS** ะดะปั ะฒัะตั ะฟะพะดะบะปััะตะฝะธะน
3. **ะฅัะฐะฝะธัะต API ัะพะบะตะฝั** ะฒ ะฑะตะทะพะฟะฐัะฝะพะผ ะผะตััะต
4. **ะะตะณัะปััะฝะพ ะพะฑะฝะพะฒะปัะนัะต** ัะธััะตะผั
5. **ะะตะปะฐะนัะต ัะตะทะตัะฒะฝัะต ะบะพะฟะธะธ** ะะ

---

## ๐ ะะฑะฝะพะฒะปะตะฝะธะต

```bash
cd xmanager
git pull
systemctl restart xui-manager
```

---

## ๐ ะัะพะฑะปะตะผั?

```bash
# ะัะพะฒะตัะบะฐ ัะตัะฒะธัะพะฒ
systemctl status xui-manager x-ui nginx

# ะะพะณะธ
journalctl -u xui-manager -f

# ะะพััั
netstat -tlnp | grep -E "8888|2096"

# ะะฐะทะฐ ะดะฐะฝะฝัั
sqlite3 /etc/x-ui/x-ui.db "SELECT COUNT(*) FROM client_traffics"
```

---

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
/opt/xui-manager/
โโโ app/
โ   โโโ main.py          # REST API
โ   โโโ database.py      # ะะฐะฑะพัะฐ ั ะะ
โ   โโโ auth.py          # ะััะตะฝัะธัะธะบะฐัะธั
โ   โโโ queue.py         # ะกะธััะตะผะฐ ะพัะตัะตะดะตะน
โ   โโโ models.py        # Pydantic ะผะพะดะตะปะธ
โ   โโโ config.py        # ะะฐัััะพะนะบะธ
โโโ templates/
โ   โโโ index.html       # ะะตะฑ-ะธะฝัะตััะตะนั
โ   โโโ login.html       # ะกััะฐะฝะธัะฐ ะฒัะพะดะฐ
โโโ requirements.txt     # Python ะทะฐะฒะธัะธะผะพััะธ
```

---

**ะะตััะธั:** 1.4.0
**ะกะพะฒะผะตััะธะผะพััั:** X-UI 2.x+, Python 3.8+
