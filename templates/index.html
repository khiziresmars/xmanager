<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>XUI Manager - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 3x-ui</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üì°</text></svg>">
    <script>
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –±–∞–∑–æ–≤—ã–π –ø—É—Ç—å –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
        (function() {
            var path = window.location.pathname;
            // –£–±–∏—Ä–∞–µ–º trailing slash –µ—Å–ª–∏ –µ—Å—Ç—å, –∑–∞—Ç–µ–º –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞—Ç–Ω–æ –¥–ª—è base
            if (path.endsWith('/')) {
                path = path;
            } else {
                path = path + '/';
            }
            // –°–æ–∑–¥–∞—ë–º base —Ç–µ–≥
            var base = document.createElement('base');
            base.href = path;
            document.head.appendChild(base);

            // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º CSS
            var css = document.createElement('link');
            css.rel = 'stylesheet';
            css.href = 'static/css/main.css';
            document.head.appendChild(css);
        })();
    </script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <!-- Mobile sidebar overlay -->
        <div class="sidebar-overlay" id="sidebar-overlay" onclick="closeSidebar()"></div>

        <div class="header">
            <div class="header-top">
                <div class="header-left">
                    <button class="mobile-menu-btn" onclick="toggleSidebar()" aria-label="–ú–µ–Ω—é">‚ò∞</button>
                    <h1>üîë –ê–≥–µ–Ω—Ç –ú–∞—Å—Ç–µ—Ä–∞ –∫–ª—é—á–µ–π</h1>
                </div>
                <button class="logout-btn" onclick="logout()">üö™ <span>–í—ã—Ö–æ–¥</span></button>
            </div>
            <p style="color: var(--text-secondary); margin-bottom: 15px;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ 3x-ui</p>

            <div class="stats-grid" id="stats">
                <div class="stat-card">
                    <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                    <div class="stat-value" id="total-users">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div>
                    <div class="stat-value" id="active-users" style="color: var(--success)">-</div>
                </div>
                <div class="stat-card" onclick="showTab('expired')" style="cursor: pointer;">
                    <div class="stat-label">–ò—Å—Ç–µ–∫—à–∏—Ö</div>
                    <div class="stat-value" id="expired-users" style="color: var(--warning)">-</div>
                </div>
                <div class="stat-card" onclick="showTab('disabled')" style="cursor: pointer;">
                    <div class="stat-label">–û—Ç–∫–ª—é—á–µ–Ω–Ω—ã—Ö</div>
                    <div class="stat-value" id="disabled-users" style="color: var(--danger)">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–ó–∞–≥—Ä—É–∂–µ–Ω–æ</div>
                    <div class="stat-value" id="total-upload" style="color: var(--warning)">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–°–∫–∞—á–∞–Ω–æ</div>
                    <div class="stat-value" id="total-download" style="color: var(--accent)">-</div>
                </div>
            </div>
        </div>

        <div class="app-layout">
            <!-- Sidebar Navigation -->
            <nav class="sidebar" id="sidebar">
                <!-- Close button for mobile -->
                <button class="mobile-sidebar-close" onclick="closeSidebar()" aria-label="–ó–∞–∫—Ä—ã—Ç—å –º–µ–Ω—é">‚úï</button>

                <!-- Users Category -->
                <div class="sidebar-category">
                    <div class="sidebar-category-title">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
                    <div class="sidebar-category-items">
                        <button class="sidebar-item active" onclick="showTab('users')">–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
                        <button class="sidebar-item sidebar-highlight" onclick="showTab('bulk-operations')">–ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</button>
                        <button class="sidebar-item" onclick="showTab('bulk-create')">–ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ</button>
                        <button class="sidebar-item" onclick="showTab('low-traffic')">–ù–∏–∑–∫–∏–π —Ç—Ä–∞—Ñ–∏–∫</button>
                        <button class="sidebar-item" onclick="showTab('unlimited')">–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ</button>
                        <button class="sidebar-item" onclick="showTab('expired')">–ò—Å—Ç–µ–∫—à–∏–µ</button>
                        <button class="sidebar-item" onclick="showTab('disabled')">–û—Ç–∫–ª—é—á–µ–Ω–Ω—ã–µ</button>
                    </div>
                </div>

                <!-- Panel Category (merged X-UI + Panel) -->
                <div class="sidebar-category">
                    <div class="sidebar-category-title">–ü–∞–Ω–µ–ª—å 3x-ui</div>
                    <div class="sidebar-category-items">
                        <button class="sidebar-item" onclick="showTab('panel')">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
                        <button class="sidebar-item" onclick="showTab('inbounds-manage')">Inbounds</button>
                        <button class="sidebar-item" onclick="showTab('ssl')">SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã</button>
                        <button class="sidebar-item" onclick="showTab('nginx-manage')">Nginx</button>
                    </div>
                </div>

                <!-- Monitoring Category -->
                <div class="sidebar-category">
                    <div class="sidebar-category-title">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</div>
                    <div class="sidebar-category-items">
                        <button class="sidebar-item" onclick="showTab('monitoring')">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                        <button class="sidebar-item" onclick="showTab('api-tokens')">API —Ç–æ–∫–µ–Ω—ã</button>
                    </div>
                </div>

                <!-- Tools Category -->
                <div class="sidebar-category">
                    <div class="sidebar-category-title">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</div>
                    <div class="sidebar-category-items">
                        <button class="sidebar-item" onclick="showTab('sni-scanner')">SNI —Å–∫–∞–Ω–µ—Ä</button>
                        <button class="sidebar-item" onclick="showTab('camouflage')">–ö–∞–º—É—Ñ–ª—è–∂</button>
                    </div>
                </div>

                <!-- System Category -->
                <div class="sidebar-category">
                    <div class="sidebar-category-title">–°–∏—Å—Ç–µ–º–∞</div>
                    <div class="sidebar-category-items">
                        <button class="sidebar-item" onclick="showTab('automation')">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è</button>
                        <button class="sidebar-item" onclick="showTab('backups')">–ë—ç–∫–∞–ø—ã</button>
                        <button class="sidebar-item" onclick="showTab('system')">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</button>
                    </div>
                </div>
            </nav>

            <!-- Main Content Area -->
            <div class="main-content">
                <!-- Legacy tabs hidden -->
                <div class="tabs">
                    <button class="tab-btn active" onclick="showTab('users')">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
                </div>

        <!-- Tab: Users -->
        <div id="tab-users" class="tab-content active">
            <h2>–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h2>

            <div class="form-row" style="margin-top: 20px;">
                <div class="form-group">
                    <label class="form-label">–ü–æ–∏—Å–∫ –ø–æ email</label>
                    <input type="text" class="form-input" id="search-users" placeholder="–í–≤–µ–¥–∏—Ç–µ email –¥–ª—è –ø–æ–∏—Å–∫–∞...">
                </div>
            </div>

            <div class="btn-group" style="margin-top: 20px;">
                <button class="btn btn-primary" onclick="loadUsers()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                <button class="btn btn-danger" onclick="deleteSelected()">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ</button>
            </div>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th><input type="checkbox" class="checkbox" onclick="toggleAllUsers(this)"></th>
                            <th>Email</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–¢—Ä–∞—Ñ–∏–∫</th>
                            <th>–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è</th>
                            <th>Inbound</th>
                        </tr>
                    </thead>
                    <tbody id="users-table-body">
                        <tr><td colspan="6" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="pagination">
                <div class="pagination-info" id="users-pagination-info">
                    –ü–æ–∫–∞–∑–∞–Ω–æ 0-0 –∏–∑ 0
                </div>
                <div class="pagination-controls">
                    <button class="page-btn" onclick="goToFirstPage()" id="users-first-btn" disabled>‚èÆÔ∏è</button>
                    <button class="page-btn" onclick="goToPrevPage()" id="users-prev-btn" disabled>‚óÄÔ∏è</button>
                    <span id="users-page-numbers" style="display: flex; gap: 5px;"></span>
                    <button class="page-btn" onclick="goToNextPage()" id="users-next-btn">‚ñ∂Ô∏è</button>
                    <button class="page-btn" onclick="goToLastPage()" id="users-last-btn">‚è≠Ô∏è</button>
                </div>
                <div class="page-size-selector">
                    <label>–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:</label>
                    <select id="page-size-select" onchange="changePageSize()">
                        <option value="10">10</option>
                        <option value="25">25</option>
                        <option value="50" selected>50</option>
                        <option value="100">100</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Tab: Bulk Operations -->
        <div id="tab-bulk-operations" class="tab-content">
            <h2>–ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</h2>
            <p style="color: var(--text-secondary); margin-bottom: 20px;">
                –í—ã–ø–æ–ª–Ω—è–π—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è —Å—Ä–∞–∑—É –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø—Ä–∏–º–µ–Ω—è–π—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ 50 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ!
            </p>

            <!-- User Selection -->
            <!-- Quick Operations - No selection needed -->
            <div style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); padding: 20px; border-radius: 8px; margin-bottom: 20px; border: 1px solid var(--accent);">
                <h3 style="margin-top: 0; margin-bottom: 15px; color: var(--accent);">–ë—ã—Å—Ç—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–±–µ–∑ –≤—ã–±–æ—Ä–∞)</h3>
                <p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 15px;">–ü—Ä–∏–º–µ–Ω–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é —Å—Ä–∞–∑—É –∫–æ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</p>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <!-- Quick extend expired -->
                    <div style="background: var(--bg-tertiary); padding: 15px; border-radius: 6px;">
                        <div style="font-size: 13px; color: var(--warning); margin-bottom: 8px; font-weight: 600;">–ò—Å—Ç–µ–∫—à–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
                        <div style="display: flex; gap: 8px; align-items: center; margin-bottom: 8px;">
                            <input type="number" id="quick-extend-days" class="form-input" value="30" min="1" max="365" style="width: 70px; padding: 6px;">
                            <span style="font-size: 12px; color: var(--text-secondary);">–¥–Ω–µ–π</span>
                        </div>
                        <button class="btn btn-success" onclick="quickExtendAllExpired()" style="width: 100%; font-size: 12px;">–ü—Ä–æ–¥–ª–∏—Ç—å –í–°–ï–• –∏—Å—Ç–µ–∫—à–∏—Ö</button>
                    </div>

                    <!-- Quick enable disabled -->
                    <div style="background: var(--bg-tertiary); padding: 15px; border-radius: 6px;">
                        <div style="font-size: 13px; color: var(--danger); margin-bottom: 8px; font-weight: 600;">–û—Ç–∫–ª—é—á–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
                        <button class="btn btn-success" onclick="quickEnableAllDisabled()" style="width: 100%; margin-bottom: 8px; font-size: 12px;">–í–∫–ª—é—á–∏—Ç—å –í–°–ï–• –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã—Ö</button>
                        <button class="btn btn-danger" onclick="quickDeleteAllDisabled()" style="width: 100%; font-size: 12px;">–£–¥–∞–ª–∏—Ç—å –í–°–ï–• –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã—Ö</button>
                    </div>

                    <!-- Quick reset expired traffic -->
                    <div style="background: var(--bg-tertiary); padding: 15px; border-radius: 6px;">
                        <div style="font-size: 13px; color: var(--accent); margin-bottom: 8px; font-weight: 600;">–°–±—Ä–æ—Å —Ç—Ä–∞—Ñ–∏–∫–∞</div>
                        <button class="btn btn-primary" onclick="quickResetTrafficExpired()" style="width: 100%; margin-bottom: 8px; font-size: 12px;">–°–±—Ä–æ—Å–∏—Ç—å —É –∏—Å—Ç–µ–∫—à–∏—Ö</button>
                        <button class="btn btn-warning" onclick="quickResetTrafficAll()" style="width: 100%; font-size: 12px;">–°–±—Ä–æ—Å–∏—Ç—å —É –í–°–ï–•</button>
                    </div>
                </div>
            </div>

            <div style="background: var(--bg-tertiary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0; margin-bottom: 15px;">–í—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Ä—É—á–Ω–æ–π)</h3>

                <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                    <button class="btn btn-primary" onclick="bulkSelectAll()">–í—ã–±—Ä–∞—Ç—å –≤—Å–µ—Ö</button>
                    <button class="btn btn-secondary" onclick="bulkSelectNone()">–°–Ω—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ</button>
                    <button class="btn btn-warning" onclick="bulkSelectExpired()">–í—ã–±—Ä–∞—Ç—å –∏—Å—Ç–µ–∫—à–∏—Ö</button>
                    <button class="btn" onclick="bulkSelectDisabled()">–í—ã–±—Ä–∞—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã—Ö</button>
                    <button class="btn" onclick="bulkSelectActive()">–í—ã–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã—Ö</button>
                </div>

                <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="text" id="bulk-search" class="form-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ email..." style="width: 250px;" oninput="bulkFilterUsers()">
                    </div>
                    <div style="color: var(--text-secondary); font-size: 14px;">
                        –í—ã–±—Ä–∞–Ω–æ: <span id="bulk-selected-count" style="color: var(--accent); font-weight: 600;">0</span> –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                    </div>
                </div>
            </div>

            <!-- Operations -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px;">
                <!-- Extend Expiry -->
                <div style="background: var(--bg-tertiary); padding: 20px; border-radius: 8px;">
                    <h4 style="margin-top: 0; color: var(--success);">–ü—Ä–æ–¥–ª–∏—Ç—å —Å—Ä–æ–∫</h4>
                    <div class="form-group">
                        <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π</label>
                        <input type="number" id="bulk-extend-days" class="form-input" value="30" min="1" max="365">
                    </div>
                    <button class="btn btn-success" onclick="bulkExtendExpiry()" style="width: 100%;">–ü—Ä–æ–¥–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–º</button>
                </div>

                <!-- Set Expiry -->
                <div style="background: var(--bg-tertiary); padding: 20px; border-radius: 8px;">
                    <h4 style="margin-top: 0; color: var(--warning);">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—É</h4>
                    <div class="form-group">
                        <label class="form-label">–î–∞—Ç–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è</label>
                        <input type="datetime-local" id="bulk-set-expiry" class="form-input">
                    </div>
                    <button class="btn btn-warning" onclick="bulkSetExpiry()" style="width: 100%;">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—É</button>
                </div>

                <!-- Add Traffic -->
                <div style="background: var(--bg-tertiary); padding: 20px; border-radius: 8px;">
                    <h4 style="margin-top: 0; color: var(--accent);">–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫</h4>
                    <div class="form-group">
                        <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (GB)</label>
                        <input type="number" id="bulk-add-traffic" class="form-input" value="10" min="1" max="1000">
                    </div>
                    <button class="btn btn-primary" onclick="bulkAddTraffic()" style="width: 100%;">–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫</button>
                </div>

                <!-- Reset Traffic -->
                <div style="background: var(--bg-tertiary); padding: 20px; border-radius: 8px;">
                    <h4 style="margin-top: 0; color: #e74c3c);">–°–±—Ä–æ—Å–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫</h4>
                    <div class="form-group">
                        <label class="form-label">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª–∏–º–∏—Ç (GB, 0 = –±–µ–∑–ª–∏–º–∏—Ç)</label>
                        <input type="number" id="bulk-reset-traffic" class="form-input" value="0" min="0">
                    </div>
                    <button class="btn btn-danger" onclick="bulkResetTraffic()" style="width: 100%;">–°–±—Ä–æ—Å–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫</button>
                </div>

                <!-- Enable/Disable -->
                <div style="background: var(--bg-tertiary); padding: 20px; border-radius: 8px;">
                    <h4 style="margin-top: 0;">–í–∫–ª—é—á–∏—Ç—å/–û—Ç–∫–ª—é—á–∏—Ç—å</h4>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-success" onclick="bulkToggleUsers(true)" style="flex: 1;">–í–∫–ª—é—á–∏—Ç—å</button>
                        <button class="btn btn-danger" onclick="bulkToggleUsers(false)" style="flex: 1;">–û—Ç–∫–ª—é—á–∏—Ç—å</button>
                    </div>
                </div>

                <!-- Delete -->
                <div style="background: var(--bg-tertiary); padding: 20px; border-radius: 8px; border: 1px solid var(--danger);">
                    <h4 style="margin-top: 0; color: var(--danger);">–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h4>
                    <p style="color: var(--text-secondary); font-size: 12px; margin-bottom: 10px;">–í–Ω–∏–º–∞–Ω–∏–µ! –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!</p>
                    <button class="btn btn-danger" onclick="bulkDeleteUsers()" style="width: 100%;">–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö</button>
                </div>
            </div>

            <!-- User List for Selection -->
            <div style="background: var(--bg-tertiary); padding: 20px; border-radius: 8px;">
                <h3 style="margin-top: 0; margin-bottom: 15px;">–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                <div style="max-height: 400px; overflow-y: auto;">
                    <table style="width: 100%;">
                        <thead style="position: sticky; top: 0; background: var(--bg-tertiary);">
                            <tr>
                                <th style="width: 40px;"><input type="checkbox" id="bulk-select-all-checkbox" onchange="bulkToggleAll(this.checked)"></th>
                                <th>Email</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–ò—Å—Ç–µ–∫–∞–µ—Ç</th>
                                <th>–¢—Ä–∞—Ñ–∏–∫</th>
                            </tr>
                        </thead>
                        <tbody id="bulk-users-table">
                            <tr><td colspan="5" style="text-align: center; padding: 20px;">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Progress -->
            <div id="bulk-progress" style="display: none; margin-top: 20px; background: var(--bg-tertiary); padding: 20px; border-radius: 8px;">
                <h4 style="margin-top: 0;">–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</h4>
                <div style="background: var(--bg-primary); border-radius: 4px; height: 20px; overflow: hidden; margin-bottom: 10px;">
                    <div id="bulk-progress-bar" style="background: var(--accent); height: 100%; width: 0%; transition: width 0.3s;"></div>
                </div>
                <div id="bulk-progress-text" style="color: var(--text-secondary); font-size: 14px;">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞...</div>
            </div>
        </div>

        <!-- Tab: Bulk Create -->
        <div id="tab-bulk-create" class="tab-content">
            <h2>–ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h2>

            <form onsubmit="bulkCreateUsers(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–ü—Ä–µ—Ñ–∏–∫—Å –∏–º–µ–Ω–∏ *</label>
                        <input type="text" class="form-input" id="bulk-prefix" value="user" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ * <span style="color: #999; font-size: 12px;">(–º–∞–∫—Å. 5000)</span></label>
                        <input type="number" class="form-input" id="bulk-count" min="1" max="5000" value="10" required>
                        <small style="color: var(--text-secondary); font-size: 12px;">–ë–æ–ª–µ–µ 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–∑–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É –æ—á–µ—Ä–µ–¥–µ–π</small>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–õ–∏–º–∏—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ (GB) *</label>
                        <input type="number" class="form-input" id="bulk-traffic" value="100" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (–¥–Ω–µ–π)</label>
                        <input type="number" class="form-input" id="bulk-expiry-days" value="30" min="0" placeholder="0 = –±–µ—Å—Å—Ä–æ—á–Ω–æ">
                        <small style="color: var(--text-secondary); font-size: 12px;">0 = –±–µ—Å—Å—Ä–æ—á–Ω–æ, > 0 = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π</small>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Inbound *</label>
                        <select class="form-select" id="bulk-inbound" required onchange="handleInboundChange()">
                            <option value="">–ó–∞–≥—Ä—É–∑–∫–∞...</option>
                        </select>
                    </div>
                    <div class="form-group" id="protocol-field-container">
                        <div id="shadowsocks-fields" style="display: none;">
                            <label class="form-label">–ú–µ—Ç–æ–¥ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (Shadowsocks)</label>
                            <select class="form-select" id="bulk-method">
                                <option value="chacha20-ietf-poly1305">chacha20-ietf-poly1305</option>
                                <option value="aes-256-gcm">aes-256-gcm</option>
                                <option value="aes-128-gcm">aes-128-gcm</option>
                            </select>
                        </div>
                        <div id="vless-fields" style="display: none;">
                            <label class="form-label">Flow (VLESS)</label>
                            <select class="form-select" id="bulk-flow">
                                <option value="">None</option>
                                <option value="xtls-rprx-vision" selected>xtls-rprx-vision</option>
                                <option value="xtls-rprx-vision-udp443">xtls-rprx-vision-udp443</option>
                            </select>
                        </div>
                        <div id="protocol-info" style="padding: 12px; background: var(--bg-tertiary); border-radius: 8px; border: 1px solid var(--border); color: var(--text-secondary); font-size: 13px;">
                            <span id="protocol-name">–í—ã–±–µ—Ä–∏—Ç–µ inbound</span>
                        </div>
                    </div>
                </div>

                <div class="form-row" style="margin-top: 20px;">
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="bulk-all-inbounds" class="checkbox" onchange="toggleMultiInboundSelection()">
                            <span style="font-weight: 500;">–°–æ–∑–¥–∞—Ç—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö inbounds</span>
                        </label>
                        <small style="color: var(--text-secondary); font-size: 12px; display: block; margin-top: 4px;">
                            –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –≤ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö inbound'–∞—Ö —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º email
                        </small>

                        <!-- –í—ã–±–æ—Ä –∏–Ω–±–∞—É–Ω–¥–æ–≤ -->
                        <div id="multi-inbound-selector" style="display: none; margin-top: 12px; padding: 12px; background: var(--bg-primary); border-radius: 8px;">
                            <div style="margin-bottom: 8px;">
                                <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; font-size: 13px;">
                                    <input type="checkbox" id="select-all-inbounds" onchange="toggleAllInbounds()" checked>
                                    <span style="font-weight: 600;">–í—ã–±—Ä–∞—Ç—å –≤—Å–µ</span>
                                </label>
                            </div>
                            <div id="inbounds-checkboxes" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 8px; margin-top: 8px;">
                                <!-- –°–ø–∏—Å–æ–∫ –∏–Ω–±–∞—É–Ω–¥–æ–≤ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </div>
                            <small id="multi-inbound-info" style="color: var(--success); font-size: 12px; display: block; margin-top: 8px;">
                                –í—ã–±—Ä–∞–Ω–æ: <span id="selected-inbounds-count">0</span> –∏–Ω–±–∞—É–Ω–¥–æ–≤
                            </small>
                        </div>

                        <small id="multi-inbound-limit-warning" style="color: var(--warning); font-size: 12px; display: none; margin-top: 8px;">
                            ‚ö†Ô∏è –ú–∞–∫—Å. 1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–ª–∏ 5000 –æ–ø–µ—Ä–∞—Ü–∏–π (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ √ó inbounds)
                        </small>
                    </div>
                </div>

                <button type="submit" class="btn btn-success">‚ú® –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</button>
            </form>

            <h3 style="margin-top: 40px;">–ê–∫—Ç–∏–≤–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>ID –æ—á–µ—Ä–µ–¥–∏</th>
                            <th>–ò–Ω–±–∞—É–Ω–¥</th>
                            <th>–ü—Ä–æ—Ç–æ–∫–æ–ª</th>
                            <th>–ü—Ä–µ—Ñ–∏–∫—Å</th>
                            <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                            <th>–ü—Ä–æ–≥—Ä–µ—Å—Å</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–°–æ–∑–¥–∞–Ω–∞</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="queues-table-body">
                        <tr><td colspan="9" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –æ—á–µ—Ä–µ–¥–µ–π...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Tab: Low Traffic -->
        <div id="tab-low-traffic" class="tab-content">
            <h2>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –Ω–∏–∑–∫–∏–º —Ç—Ä–∞—Ñ–∏–∫–æ–º</h2>

            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">–ü–æ—Ä–æ–≥ —Ç—Ä–∞—Ñ–∏–∫–∞ (–±–∞–π—Ç)</label>
                    <input type="number" class="form-input" id="low-traffic-threshold" value="1024" min="0">
                </div>
                <div class="form-group">
                    <label class="form-label">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</label>
                    <select class="form-select" id="low-traffic-sort">
                        <option value="remaining">–ü–æ –æ—Å—Ç–∞—Ç–∫—É</option>
                        <option value="used">–ü–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–º—É</option>
                        <option value="email">–ü–æ email</option>
                    </select>
                </div>
            </div>

            <div class="btn-group" style="margin-top: 20px;">
                <button class="btn btn-primary" onclick="loadLowTrafficUsers()">üîç –ù–∞–π—Ç–∏</button>
                <button class="btn btn-secondary" onclick="resetTrafficSelected()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫</button>
                <button class="btn btn-danger" onclick="deleteLowTrafficSelected()">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö</button>
            </div>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th><input type="checkbox" class="checkbox" onclick="toggleAllLowTraffic(this)"></th>
                            <th>Email</th>
                            <th>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ</th>
                            <th>–û—Å—Ç–∞—Ç–æ–∫</th>
                            <th>–õ–∏–º–∏—Ç</th>
                        </tr>
                    </thead>
                    <tbody id="low-traffic-table-body">
                        <tr><td colspan="5" class="loading">–ù–∞–∂–º–∏—Ç–µ "–ù–∞–π—Ç–∏" –¥–ª—è –ø–æ–∏—Å–∫–∞</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Tab: Unlimited -->
        <div id="tab-unlimited" class="tab-content">
            <h2>–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º</h2>
            <p style="color: #666; margin-bottom: 20px; font-size: 14px;">
                –ù–∞–π–¥–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º –±–µ–∑–ª–∏–º–∏—Ç–∞ (–≤—Ä–µ–º—è, —Ç—Ä–∞—Ñ–∏–∫ –∏–ª–∏ –æ–±–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞)
            </p>

            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">–¢–∏–ø —Ñ–∏–ª—å—Ç—Ä–∞ <span style="color: #999; font-size: 12px;">(–≤—ã–±–µ—Ä–∏—Ç–µ –∫—Ä–∏—Ç–µ—Ä–∏–π –ø–æ–∏—Å–∫–∞)</span></label>
                    <select class="form-select" id="unlimited-filter-type" onchange="updateFilterDescription()">
                        <option value="expiry">–ë–µ—Å—Å—Ä–æ—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–±–µ–∑ –¥–∞—Ç—ã –∏—Å—Ç–µ—á–µ–Ω–∏—è)</option>
                        <option value="traffic">–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ (–Ω–µ—Ç –ª–∏–º–∏—Ç–∞ —Ç—Ä–∞—Ñ–∏–∫–∞)</option>
                        <option value="both">–û–±–∞ –∫—Ä–∏—Ç–µ—Ä–∏—è (–±–µ—Å—Å—Ä–æ—á–Ω—ã–µ –ò –±–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫)</option>
                    </select>
                    <small id="filter-description" style="display: block; margin-top: 8px; color: #0066cc; font-size: 13px;">
                        üìå –ë—É–¥—É—Ç –Ω–∞–π–¥–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (expiry_time = 0)
                    </small>
                </div>
                <div class="form-group">
                    <label class="form-label">–ú–∞–∫—Å. —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ <span style="color: #999; font-size: 12px;">(0 = –≤—Å–µ)</span></label>
                    <input type="number" class="form-input" id="unlimited-limit" value="100" min="0" max="10000">
                </div>
                <div class="form-group">
                    <label class="form-label">–ü—Ä–æ–¥–ª–∏—Ç—å –Ω–∞ (–¥–Ω–µ–π)</label>
                    <input type="number" class="form-input" id="unlimited-extend-days" value="30" min="1">
                </div>
            </div>

            <div class="btn-group" style="margin-top: 20px;">
                <button class="btn btn-primary" onclick="loadUnlimitedUsers()">üîç –ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</button>
                <button class="btn btn-success" onclick="extendUnlimitedExpiry()">üìÖ –ü—Ä–æ–¥–ª–∏—Ç—å —Å—Ä–æ–∫ –≤—ã–±—Ä–∞–Ω–Ω—ã–º</button>
                <button class="btn btn-secondary" onclick="resetTrafficUnlimited()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫</button>
                <button class="btn btn-info" onclick="addTrafficUnlimited()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫</button>
                <button class="btn btn-warning" onclick="setLimitUnlimited()">üìä –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª–∏–º–∏—Ç</button>
                <button class="btn btn-danger" onclick="blockUnlimitedSelected()">üö´ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö</button>
            </div>

            <!-- Status bar showing filter and results -->
            <div id="unlimited-status-bar" style="display: none; margin: 20px 0; padding: 12px; background: #e8f4fd; border-left: 4px solid #0066cc; border-radius: 4px;">
                <strong>–ê–∫—Ç–∏–≤–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä:</strong> <span id="unlimited-active-filter"></span> |
                <strong>–ù–∞–π–¥–µ–Ω–æ:</strong> <span id="unlimited-results-count">0</span> –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            </div>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th><input type="checkbox" class="checkbox" onclick="toggleAllUnlimited(this)"></th>
                            <th>Email</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ</th>
                            <th>–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="unlimited-table-body">
                        <tr><td colspan="5" class="loading">
                            –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ñ–∏–ª—å—Ç—Ä–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ "–ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π" –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø–æ–∏—Å–∫–∞
                        </td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Tab: Expired Users -->
        <div id="tab-expired" class="tab-content">
            <h2>–ò—Å—Ç–µ–∫—à–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h2>
            <p style="color: #666; margin-bottom: 20px; font-size: 14px;">
                –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –∏—Å—Ç–µ–∫—à–∏–º —Å—Ä–æ–∫–æ–º –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–¥–ø–∏—Å–∫–∏
            </p>

            <div class="btn-group" style="margin-top: 20px; flex-wrap: wrap;">
                <button class="btn btn-primary" onclick="loadExpiredUsers()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫</button>
                <button class="btn btn-success" onclick="showExtendExpiredModal()">‚úÖ –ü—Ä–æ–¥–ª–∏—Ç—å –∏ –≤–∫–ª—é—á–∏—Ç—å</button>
                <button class="btn btn-danger" onclick="deleteExpiredSelected()">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö</button>
                <button class="btn btn-warning" onclick="deleteAllExpired()">‚ö†Ô∏è –£–¥–∞–ª–∏—Ç—å –≤—Å–µ—Ö –∏—Å—Ç–µ–∫—à–∏—Ö</button>
            </div>

            <!-- Extend Expired Modal -->
            <div id="extend-expired-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
                <div style="background: var(--bg-secondary); padding: 30px; border-radius: 12px; max-width: 500px; width: 90%;">
                    <h3 style="margin-top: 0;">–ü—Ä–æ–¥–ª–∏—Ç—å –∏ –≤–∫–ª—é—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 20px;">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø—Ä–æ–¥–ª–µ–Ω–∏—è</p>

                    <div class="form-group" style="margin-bottom: 20px;">
                        <label class="form-label">–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (–¥–Ω–µ–π)</label>
                        <input type="number" class="form-input" id="extend-expiry-days" value="30" min="1">
                    </div>

                    <div class="form-group" style="margin-bottom: 20px;">
                        <label class="form-label">–°–±—Ä–æ—Å–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫</label>
                        <select class="form-input" id="extend-reset-traffic">
                            <option value="no">–ù–µ—Ç</option>
                            <option value="yes">–î–∞</option>
                        </select>
                    </div>

                    <div class="btn-group">
                        <button class="btn btn-success" onclick="extendExpiredUsers()">‚úÖ –ü—Ä–æ–¥–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö</button>
                        <button class="btn btn-warning" onclick="extendAllExpiredUsers()">‚ö° –ü—Ä–æ–¥–ª–∏—Ç—å –≤—Å–µ—Ö</button>
                        <button class="btn btn-secondary" onclick="closeExtendExpiredModal()">–û—Ç–º–µ–Ω–∞</button>
                    </div>
                </div>
            </div>

            <div class="table-container" style="margin-top: 20px;">
                <table>
                    <thead>
                        <tr>
                            <th><input type="checkbox" class="checkbox" onclick="toggleAllExpired(this)"></th>
                            <th>Email</th>
                            <th>Inbound ID</th>
                            <th>–ò—Å—Ç–µ–∫</th>
                            <th>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                        </tr>
                    </thead>
                    <tbody id="expired-table-body">
                        <tr><td colspan="6" class="loading">–ù–∞–∂–º–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫" –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Tab: Disabled Users -->
        <div id="tab-disabled" class="tab-content">
            <h2>–û—Ç–∫–ª—é—á–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h2>
            <p style="color: #666; margin-bottom: 20px; font-size: 14px;">
                –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–º (–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º) —Å—Ç–∞—Ç—É—Å–æ–º
            </p>

            <div class="btn-group" style="margin-top: 20px;">
                <button class="btn btn-primary" onclick="loadDisabledUsers()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫</button>
                <button class="btn btn-danger" onclick="deleteDisabledSelected()">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö</button>
                <button class="btn btn-warning" onclick="deleteAllDisabled()">‚ö†Ô∏è –£–¥–∞–ª–∏—Ç—å –≤—Å–µ—Ö –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã—Ö</button>
                <button class="btn btn-success" onclick="showEnableModal()">‚úÖ –í–∫–ª—é—á–∏—Ç—å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏</button>
            </div>

            <!-- Enable Users Modal -->
            <div id="enable-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
                <div style="background: var(--bg-secondary); padding: 30px; border-radius: 12px; max-width: 500px; width: 90%;">
                    <h3 style="margin-top: 0;">–í–∫–ª—é—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 20px;">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤–∫–ª—é—á–∞–µ–º—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>

                    <div class="form-group" style="margin-bottom: 20px;">
                        <label class="form-label">–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (–¥–Ω–µ–π)</label>
                        <input type="number" class="form-input" id="enable-expiry-days" value="30" min="0">
                        <small style="color: var(--text-secondary); font-size: 12px;">0 = –±–µ—Å—Å—Ä–æ—á–Ω–æ</small>
                    </div>

                    <div class="form-group" style="margin-bottom: 20px;">
                        <label class="form-label">–õ–∏–º–∏—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ (GB)</label>
                        <input type="number" class="form-input" id="enable-traffic-gb" value="100" min="0">
                        <small style="color: var(--text-secondary); font-size: 12px;">0 = –±–µ–∑–ª–∏–º–∏—Ç</small>
                    </div>

                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button class="btn btn-secondary" onclick="closeEnableModal()">–û—Ç–º–µ–Ω–∞</button>
                        <button class="btn btn-success" onclick="confirmEnableUsers()">‚úÖ –í–∫–ª—é—á–∏—Ç—å</button>
                    </div>
                </div>
            </div>

            <div class="table-container" style="margin-top: 20px;">
                <table>
                    <thead>
                        <tr>
                            <th><input type="checkbox" class="checkbox" onclick="toggleAllDisabled(this)"></th>
                            <th>Email</th>
                            <th>Inbound ID</th>
                            <th>–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è</th>
                            <th>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ</th>
                        </tr>
                    </thead>
                    <tbody id="disabled-table-body">
                        <tr><td colspan="5" class="loading">–ù–∞–∂–º–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫" –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Update Progress Modal -->
        <div id="update-progress-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; align-items: center; justify-content: center;">
            <div style="background: var(--bg-secondary); padding: 40px; border-radius: 12px; max-width: 600px; width: 90%; box-shadow: 0 10px 40px rgba(0,0,0,0.5);">
                <h3 style="margin-top: 0; text-align: center;">üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</h3>

                <div id="update-progress-stage" style="text-align: center; margin: 20px 0; font-size: 16px; color: var(--accent); font-weight: 500;">
                    –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞...
                </div>

                <!-- Progress Bar -->
                <div style="background: var(--bg-primary); height: 30px; border-radius: 15px; margin: 20px 0; overflow: hidden; position: relative;">
                    <div id="update-progress-bar" style="background: linear-gradient(90deg, var(--accent), var(--success)); height: 100%; width: 0%; transition: width 0.5s; border-radius: 15px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 14px;">
                        0%
                    </div>
                </div>

                <div id="update-progress-message" style="text-align: center; color: var(--text-secondary); font-size: 14px; min-height: 40px; margin: 15px 0;">
                    –ù–∞—á–∞–ª–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è...
                </div>

                <div id="update-success-message" style="display: none; text-align: center; color: var(--success); font-size: 16px; margin: 20px 0; padding: 15px; background: rgba(76, 175, 80, 0.1); border-radius: 8px;">
                    ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!<br>
                    <small style="font-size: 13px;">–°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—Å—è —á–µ—Ä–µ–∑ <span id="reload-countdown">5</span> —Å–µ–∫...</small>
                </div>

                <div id="update-error-message" style="display: none; text-align: center; color: var(--danger); font-size: 14px; margin: 20px 0; padding: 15px; background: rgba(244, 67, 54, 0.1); border-radius: 8px; white-space: pre-wrap;">
                </div>

                <div style="text-align: center; margin-top: 25px;">
                    <button id="close-update-modal-btn" class="btn btn-secondary" onclick="closeUpdateModal()" style="display: none;">
                        –ó–∞–∫—Ä—ã—Ç—å
                    </button>
                </div>

                <div style="margin-top: 20px; padding: 15px; background: var(--bg-primary); border-radius: 8px; font-size: 12px; color: var(--text-secondary);">
                    <strong>‚ÑπÔ∏è –í–∞–∂–Ω–æ:</strong> –ù–µ –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ —ç—Ç–æ –æ–∫–Ω–æ –∏ –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.
                </div>
            </div>
        </div>

        <!-- SSL Renewal Progress Modal -->
        <div id="ssl-progress-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; align-items: center; justify-content: center;">
            <div style="background: var(--bg-secondary); padding: 40px; border-radius: 12px; max-width: 600px; width: 90%; box-shadow: 0 10px 40px rgba(0,0,0,0.5);">
                <h3 style="margin-top: 0; text-align: center;">üîê –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞</h3>
                <div id="ssl-progress-message" style="text-align: center; margin: 20px 0; font-size: 16px; color: var(--accent);">
                    –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞...
                </div>
                <div id="ssl-success-message" style="display: none; text-align: center; color: var(--success); font-size: 16px; margin: 20px 0; padding: 15px; background: rgba(76, 175, 80, 0.1); border-radius: 8px;">
                </div>
                <div id="ssl-error-message" style="display: none; text-align: center; color: var(--danger); font-size: 14px; margin: 20px 0; padding: 15px; background: rgba(244, 67, 54, 0.1); border-radius: 8px;">
                </div>
                <div style="text-align: center; margin-top: 25px;">
                    <button id="close-ssl-modal-btn" class="btn btn-secondary" onclick="closeSSLModal()" style="display: none;">
                        –ó–∞–∫—Ä—ã—Ç—å
                    </button>
                </div>
            </div>
        </div>

        <!-- Tab: SNI Scanner -->
        <div id="tab-sni-scanner" class="tab-content">
            <h2>üîç SNI Scanner –¥–ª—è Reality</h2>
            <p style="color: var(--text-secondary); margin-bottom: 20px; font-size: 14px;">
                –ü–æ–∏—Å–∫ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–º–µ–Ω–æ–≤ –¥–ª—è Reality SNI (TLS 1.3 + H2)
            </p>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <!-- Single Domain Test -->
                <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px;">
                    <h3 style="margin-top: 0; font-size: 16px;">–¢–µ—Å—Ç –æ–¥–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞</h3>
                    <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                        <input type="text" class="form-input" id="sni-single-domain" placeholder="example.com" style="flex: 1;">
                        <button class="btn btn-primary" onclick="testSingleSNI()">üîç –¢–µ—Å—Ç</button>
                    </div>
                    <div id="sni-single-result" style="font-size: 13px; color: var(--text-secondary);"></div>
                </div>

                <!-- Saved Domains -->
                <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px;">
                    <h3 style="margin-top: 0; font-size: 16px;">–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã</h3>
                    <div id="sni-saved-list" style="max-height: 150px; overflow-y: auto; font-size: 13px;">
                        <span style="color: var(--text-secondary);">–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤</span>
                    </div>
                </div>
            </div>

            <!-- Auto Discovery -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0; font-size: 16px;">üîé –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ SNI</h3>
                <p style="color: var(--text-secondary); font-size: 12px; margin-bottom: 15px;">
                    –°–∫–∞–Ω–∏—Ä—É–µ—Ç IP –¥–∏–∞–ø–∞–∑–æ–Ω—ã CDN –∏ –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –¥–æ–º–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
                </p>
                <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
                    <select class="form-input" id="sni-provider" style="width: auto; min-width: 140px;">
                        <option value="local">üè† –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç—å</option>
                        <option value="all">üåê –í—Å–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã</option>
                        <option value="cloudflare">Cloudflare</option>
                        <option value="google">Google</option>
                        <option value="amazon">Amazon</option>
                        <option value="microsoft">Microsoft</option>
                        <option value="fastly">Fastly</option>
                    </select>
                    <input type="number" class="form-input" id="sni-discover-count" value="20" min="5" max="50" style="width: 70px;" title="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ">
                    <button class="btn btn-success" onclick="discoverSNI()">üöÄ –ù–∞–π—Ç–∏</button>
                </div>
            </div>

            <!-- Manual Bulk Scan -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0; font-size: 16px;">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–∏—Å–∫–∞ –¥–æ–º–µ–Ω–æ–≤</h3>
                <div class="btn-group" style="margin-bottom: 15px;">
                    <button class="btn btn-secondary" onclick="loadSNISuggestions()">üìã –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ</button>
                    <button class="btn btn-primary" onclick="scanSNIDomains()">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                </div>
                <textarea class="form-input" id="sni-domains-list" rows="3" placeholder="–î–æ–º–µ–Ω—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É)" style="font-family: monospace; font-size: 12px;"></textarea>
            </div>

            <!-- Scan Results -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px;">
                <h3 style="margin-top: 0; font-size: 16px;">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
                <div class="table-container">
                    <table id="sni-results-table">
                        <thead>
                            <tr>
                                <th>–î–æ–º–µ–Ω</th>
                                <th>TLS 1.3</th>
                                <th>H2</th>
                                <th>Latency</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="sni-results-body">
                            <tr><td colspan="6" style="text-align: center; padding: 20px; color: var(--text-secondary);">–ù–∞–∂–º–∏—Ç–µ "–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å" –¥–ª—è –Ω–∞—á–∞–ª–∞</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Tab: SSL Certificate Management -->
        <div id="tab-ssl" class="tab-content">
            <h2>üîê –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º</h2>
            <p style="color: #666; margin-bottom: 20px; font-size: 14px;">
                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º Let's Encrypt –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å 3x-ui
            </p>

            <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); margin-bottom: 30px;">
                <div class="stat-card">
                    <div class="stat-label">–î–æ–º–µ–Ω</div>
                    <div class="stat-value" id="ssl-domain" style="font-size: 18px;">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–°—Ç–∞—Ç—É—Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞</div>
                    <div class="stat-value" id="ssl-status" style="font-size: 18px;">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–î–Ω–µ–π –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è</div>
                    <div class="stat-value" id="ssl-days-left" style="font-size: 24px;">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–ò—Å—Ç–µ–∫–∞–µ—Ç</div>
                    <div class="stat-value" id="ssl-expiry-date" style="font-size: 16px;">-</div>
                </div>
            </div>

            <div class="btn-group" style="margin-bottom: 20px;">
                <button class="btn btn-primary" onclick="loadSSLStatus()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å</button>
                <button class="btn btn-success" onclick="renewSSLCertificate(false)">üîê –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</button>
                <button class="btn btn-warning" onclick="renewSSLCertificate(true)">‚ö° –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</button>
            </div>

            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                <div class="btn-group" style="margin-top: 15px;">
                    <button class="btn btn-secondary" onclick="update3xuiCertificate()">üìã –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤ 3x-ui</button>
                    <button class="btn btn-secondary" onclick="restartSSLServices()">üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã</button>
                </div>
                <p style="color: #888; font-size: 12px; margin-top: 15px; margin-bottom: 0;">
                    ‚ÑπÔ∏è "–û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤ 3x-ui" - –æ–±–Ω–æ–≤–ª—è–µ—Ç –ø—É—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –≤ –ø–∞–Ω–µ–ª–∏ 3x-ui –±–µ–∑ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∞–º–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞.<br>
                    ‚ÑπÔ∏è "–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã" - –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç Nginx –∏ 3x-ui –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.
                </p>
            </div>

            <div id="ssl-info-details" style="background: var(--bg-secondary); padding: 20px; border-radius: 8px;">
                <h3 style="margin-top: 0;">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ</h3>
                <div id="ssl-cert-details" style="font-family: monospace; font-size: 13px; color: var(--text-secondary);">
                    –ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏...
                </div>
            </div>
        </div>

        <!-- Tab: Inbounds Management -->
        <div id="tab-inbounds-manage" class="tab-content">
            <h2>üì° –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Inbounds</h2>
            <p style="color: #666; margin-bottom: 20px; font-size: 14px;">
                –ü—Ä–æ—Å–º–æ—Ç—Ä, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ inbounds
            </p>

            <!-- Optimization Section -->
            <div style="background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%); border-radius: 12px; padding: 20px; margin-bottom: 25px; border: 1px solid var(--border);">
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                    <span style="font-size: 24px;">‚ö°</span>
                    <div>
                        <h3 style="margin: 0; font-size: 16px;">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ —à–∞–±–ª–æ–Ω—ã</h3>
                        <p style="margin: 0; font-size: 12px; color: var(--text-secondary);">–ë—ã—Å—Ç—Ä–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ inbound –ø–æ –≥–æ—Ç–æ–≤—ã–º —à–∞–±–ª–æ–Ω–∞–º</p>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;">
                    <!-- VLESS + Reality -->
                    <button class="preset-create-btn" onclick="createInboundFromPreset('vless_reality')" style="display: flex; align-items: center; gap: 10px; padding: 12px 15px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px; cursor: pointer; text-align: left; transition: all 0.2s;">
                        <span style="font-size: 20px;">üé≠</span>
                        <div>
                            <div style="font-weight: 600; font-size: 13px; color: var(--text-primary);">VLESS + Reality</div>
                            <div style="font-size: 11px; color: #9b59b6;">TCP ‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π</div>
                        </div>
                    </button>

                    <!-- VLESS + WS + TLS -->
                    <button class="preset-create-btn" onclick="createInboundFromPreset('vless_ws_tls')" style="display: flex; align-items: center; gap: 10px; padding: 12px 15px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px; cursor: pointer; text-align: left; transition: all 0.2s;">
                        <span style="font-size: 20px;">üîå</span>
                        <div>
                            <div style="font-weight: 600; font-size: 13px; color: var(--text-primary);">VLESS + WS + TLS</div>
                            <div style="font-size: 11px; color: #27ae60;">WebSocket ‚Ä¢ CDN</div>
                        </div>
                    </button>

                    <!-- Trojan + TLS -->
                    <button class="preset-create-btn" onclick="createInboundFromPreset('trojan_tls')" style="display: flex; align-items: center; gap: 10px; padding: 12px 15px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px; cursor: pointer; text-align: left; transition: all 0.2s;">
                        <span style="font-size: 20px;">üê¥</span>
                        <div>
                            <div style="font-weight: 600; font-size: 13px; color: var(--text-primary);">Trojan + TLS</div>
                            <div style="font-size: 11px; color: #e74c3c;">TCP ‚Ä¢ HTTPS</div>
                        </div>
                    </button>

                    <!-- Shadowsocks -->
                    <button class="preset-create-btn" onclick="createInboundFromPreset('shadowsocks')" style="display: flex; align-items: center; gap: 10px; padding: 12px 15px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px; cursor: pointer; text-align: left; transition: all 0.2s;">
                        <span style="font-size: 20px;">üåë</span>
                        <div>
                            <div style="font-weight: 600; font-size: 13px; color: var(--text-primary);">Shadowsocks</div>
                            <div style="font-size: 11px; color: #95a5a6;">2022 ‚Ä¢ AEAD</div>
                        </div>
                    </button>
                </div>

                <!-- Mass optimization buttons -->
                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid var(--border); display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn btn-secondary" onclick="updateAllFingerprints()" style="font-size: 12px;">
                        üîÑ –û–±–Ω–æ–≤–∏—Ç—å Fingerprint –Ω–∞ –≤—Å–µ—Ö
                    </button>
                    <button class="btn btn-secondary" onclick="showBulkOptimizeModal()" style="font-size: 12px;">
                        ‚öôÔ∏è –ú–∞—Å—Å–æ–≤–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
                    </button>
                </div>
            </div>

            <!-- Advanced Tools Section -->
            <div style="background: var(--bg-secondary); border-radius: 12px; padding: 15px; margin-bottom: 20px; border: 1px solid var(--border);">
                <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 10px;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 18px;">üõ†Ô∏è</span>
                        <span style="font-weight: 600; font-size: 14px;">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</span>
                    </div>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                        <button class="btn btn-primary btn-sm" onclick="loadInboundsTable()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                        <button class="btn btn-accent btn-sm" onclick="showPresetSelectorModal()" title="–í—ã–±—Ä–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏">üìã –®–∞–±–ª–æ–Ω—ã</button>
                        <button class="btn btn-secondary btn-sm" onclick="showInboundsStats()">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                        <button class="btn btn-secondary btn-sm" onclick="checkAllHealth()">üè• –ü—Ä–æ–≤–µ—Ä–∫–∞</button>
                        <button class="btn btn-secondary btn-sm" onclick="exportAllInbounds()">üì§ –≠–∫—Å–ø–æ—Ä—Ç</button>
                        <button class="btn btn-secondary btn-sm" onclick="showImportModal()">üì• –ò–º–ø–æ—Ä—Ç</button>
                    </div>
                </div>

                <!-- Bulk selection toolbar (hidden by default) -->
                <div id="bulk-toolbar" style="display: none; margin-top: 15px; padding-top: 15px; border-top: 1px solid var(--border);">
                    <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="select-all-inbounds" onchange="toggleAllInbounds(this.checked)" style="width: 18px; height: 18px;">
                            <span style="font-size: 13px;">–í—ã–±—Ä–∞—Ç—å –≤—Å–µ</span>
                        </label>
                        <span id="selected-count" style="font-size: 13px; color: var(--text-secondary);">0 –≤—ã–±—Ä–∞–Ω–æ</span>
                        <div style="flex: 1;"></div>
                        <button class="btn btn-success btn-sm" onclick="bulkToggleInbounds(true)" style="font-size: 12px;">‚úÖ –í–∫–ª—é—á–∏—Ç—å</button>
                        <button class="btn btn-warning btn-sm" onclick="bulkToggleInbounds(false)" style="font-size: 12px;">‚è∏Ô∏è –í—ã–∫–ª—é—á–∏—Ç—å</button>
                        <button class="btn btn-danger btn-sm" onclick="bulkDeleteInbounds()" style="font-size: 12px;">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                </div>
            </div>

            <!-- Compact accordion-style inbound list -->
            <div id="inbounds-list-container">
                <div style="text-align: center; padding: 20px; color: #666;">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
        </div>

        <!-- Inbound Edit Modal - Enhanced Visual Editor -->
        <div id="inbound-edit-modal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 900px;">
                <div class="modal-header">
                    <h3 id="inbound-modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å Inbound</h3>
                    <button class="modal-close" onclick="closeInboundModal()">&times;</button>
                </div>
                <div class="modal-body" style="max-height: 75vh; overflow-y: auto; padding: 0;">
                    <input type="hidden" id="edit-inbound-id">
                    <input type="hidden" id="edit-inbound-security-type">
                    <input type="hidden" id="edit-inbound-network-type">

                    <!-- Modal Tabs -->
                    <div class="modal-tabs" style="display: flex; border-bottom: 1px solid var(--border-color); background: var(--bg-secondary); flex-wrap: wrap;">
                        <button class="modal-tab active" data-tab="basic" onclick="switchInboundTab('basic')">üìã –û—Å–Ω–æ–≤–Ω–æ–µ</button>
                        <button class="modal-tab" data-tab="transport" onclick="switchInboundTab('transport')">üîÑ –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</button>
                        <button class="modal-tab" data-tab="security" onclick="switchInboundTab('security')">üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</button>
                        <button class="modal-tab" data-tab="presets" onclick="switchInboundTab('presets')">üì¶ –®–∞–±–ª–æ–Ω—ã</button>
                        <button class="modal-tab" data-tab="advanced" onclick="switchInboundTab('advanced')">‚öôÔ∏è JSON</button>
                    </div>

                    <!-- Tab: Basic -->
                    <div class="modal-tab-content active" id="inbound-tab-basic" style="padding: 20px;">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ (Remark)</label>
                                <input type="text" class="form-input" id="edit-inbound-remark" placeholder="my-vless-reality">
                            </div>
                            <div class="form-group">
                                <label class="form-label">–ü–æ—Ä—Ç</label>
                                <div style="display: flex; gap: 8px;">
                                    <input type="number" class="form-input" id="edit-inbound-port" style="flex: 1;">
                                    <button class="btn btn-secondary" onclick="generateRandomPort()" title="–°–ª—É—á–∞–π–Ω—ã–π –ø–æ—Ä—Ç">üé≤</button>
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">–ü—Ä–æ—Ç–æ–∫–æ–ª</label>
                                <input type="text" class="form-input" id="edit-inbound-protocol" readonly style="background: var(--bg-tertiary);">
                            </div>
                            <div class="form-group">
                                <label class="form-label">–°—Ç–∞—Ç—É—Å</label>
                                <select class="form-input" id="edit-inbound-enable">
                                    <option value="1">‚úÖ –í–∫–ª—é—á–µ–Ω</option>
                                    <option value="0">‚ùå –í—ã–∫–ª—é—á–µ–Ω</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Listen IP (–ø—É—Å—Ç–æ = –≤—Å–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã)</label>
                            <input type="text" class="form-input" id="edit-inbound-listen" placeholder="0.0.0.0 –∏–ª–∏ –ø—É—Å—Ç–æ">
                        </div>

                        <!-- Sniffing Settings -->
                        <div style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; margin-top: 15px;">
                            <label class="form-label" style="margin-bottom: 10px;">Sniffing</label>
                            <div class="form-row">
                                <div class="form-group" style="flex: 0 0 120px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="checkbox" id="edit-sniffing-enabled" checked>
                                        <span>–í–∫–ª—é—á–µ–Ω</span>
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Dest Override</label>
                                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                        <label style="display: flex; align-items: center; gap: 4px; cursor: pointer;">
                                            <input type="checkbox" id="sniff-http" checked> HTTP
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 4px; cursor: pointer;">
                                            <input type="checkbox" id="sniff-tls" checked> TLS
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 4px; cursor: pointer;">
                                            <input type="checkbox" id="sniff-quic" checked> QUIC
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 4px; cursor: pointer;">
                                            <input type="checkbox" id="sniff-fakedns"> FakeDNS
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: Transport -->
                    <div class="modal-tab-content" id="inbound-tab-transport" style="padding: 20px; display: none;">
                        <div class="form-group">
                            <label class="form-label">–¢–∏–ø —Å–µ—Ç–∏ (Network)</label>
                            <select class="form-input" id="edit-network-type" onchange="updateTransportFields()">
                                <option value="tcp">TCP</option>
                                <option value="ws">WebSocket</option>
                                <option value="grpc">gRPC</option>
                                <option value="httpupgrade">HTTPUpgrade</option>
                                <option value="splithttp">SplitHTTP</option>
                                <option value="kcp">mKCP</option>
                                <option value="quic">QUIC</option>
                            </select>
                        </div>

                        <!-- WebSocket Settings -->
                        <div id="transport-ws-settings" style="display: none; background: var(--bg-tertiary); padding: 15px; border-radius: 8px; margin-top: 15px;">
                            <h4 style="margin: 0 0 15px 0; color: var(--primary);">üîå WebSocket</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Path</label>
                                    <div style="display: flex; gap: 8px;">
                                        <input type="text" class="form-input" id="edit-ws-path" placeholder="/ws" style="flex: 1;">
                                        <button class="btn btn-secondary" onclick="generateRandomPath()" title="–°–ª—É—á–∞–π–Ω—ã–π –ø—É—Ç—å">üé≤</button>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Host</label>
                                    <input type="text" class="form-input" id="edit-ws-host" placeholder="example.com">
                                </div>
                            </div>
                        </div>

                        <!-- gRPC Settings -->
                        <div id="transport-grpc-settings" style="display: none; background: var(--bg-tertiary); padding: 15px; border-radius: 8px; margin-top: 15px;">
                            <h4 style="margin: 0 0 15px 0; color: var(--primary);">üì° gRPC</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Service Name</label>
                                    <div style="display: flex; gap: 8px;">
                                        <input type="text" class="form-input" id="edit-grpc-service" placeholder="grpc-service" style="flex: 1;">
                                        <button class="btn btn-secondary" onclick="generateRandomServiceName()" title="–°–ª—É—á–∞–π–Ω–æ–µ –∏–º—è">üé≤</button>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Mode</label>
                                    <select class="form-input" id="edit-grpc-mode">
                                        <option value="gun">gun</option>
                                        <option value="multi">multi</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- HTTPUpgrade Settings -->
                        <div id="transport-httpupgrade-settings" style="display: none; background: var(--bg-tertiary); padding: 15px; border-radius: 8px; margin-top: 15px;">
                            <h4 style="margin: 0 0 15px 0; color: var(--primary);">‚¨ÜÔ∏è HTTPUpgrade</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Path</label>
                                    <div style="display: flex; gap: 8px;">
                                        <input type="text" class="form-input" id="edit-httpupgrade-path" placeholder="/httpupgrade" style="flex: 1;">
                                        <button class="btn btn-secondary" onclick="document.getElementById('edit-httpupgrade-path').value = '/' + generateRandomString(8)" title="–°–ª—É—á–∞–π–Ω—ã–π –ø—É—Ç—å">üé≤</button>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Host</label>
                                    <input type="text" class="form-input" id="edit-httpupgrade-host" placeholder="example.com">
                                </div>
                            </div>
                        </div>

                        <!-- SplitHTTP Settings -->
                        <div id="transport-splithttp-settings" style="display: none; background: var(--bg-tertiary); padding: 15px; border-radius: 8px; margin-top: 15px;">
                            <h4 style="margin: 0 0 15px 0; color: var(--primary);">‚úÇÔ∏è SplitHTTP</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Path</label>
                                    <input type="text" class="form-input" id="edit-splithttp-path" placeholder="/splithttp">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Host</label>
                                    <input type="text" class="form-input" id="edit-splithttp-host" placeholder="example.com">
                                </div>
                            </div>
                        </div>

                        <!-- TCP Settings -->
                        <div id="transport-tcp-settings" style="display: none; background: var(--bg-tertiary); padding: 15px; border-radius: 8px; margin-top: 15px;">
                            <h4 style="margin: 0 0 15px 0; color: var(--primary);">üîó TCP</h4>
                            <div class="form-group">
                                <label class="form-label">Header Type</label>
                                <select class="form-input" id="edit-tcp-header-type">
                                    <option value="none">none</option>
                                    <option value="http">http</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: Security -->
                    <div class="modal-tab-content" id="inbound-tab-security" style="padding: 20px; display: none;">
                        <div class="form-group">
                            <label class="form-label">–¢–∏–ø –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (Security)</label>
                            <select class="form-input" id="edit-security-type" onchange="updateSecurityFields()">
                                <option value="none">none (–±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è)</option>
                                <option value="tls">TLS</option>
                                <option value="reality">Reality</option>
                            </select>
                        </div>

                        <!-- Reality Settings -->
                        <div id="security-reality-settings" style="display: none; background: var(--bg-tertiary); padding: 15px; border-radius: 8px; margin-top: 15px;">
                            <h4 style="margin: 0 0 15px 0; color: #9b59b6;">üé≠ Reality Settings</h4>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Dest (—Ü–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä)</label>
                                    <input type="text" class="form-input" id="edit-reality-dest" placeholder="www.microsoft.com:443">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Server Names (SNI)</label>
                                    <div style="display: flex; gap: 8px;">
                                        <select class="form-input" id="edit-reality-sni-select" style="flex: 1;" onchange="document.getElementById('edit-reality-sni').value = this.value">
                                            <option value="">-- –í—ã–±—Ä–∞—Ç—å --</option>
                                            <option value="www.microsoft.com">microsoft.com</option>
                                            <option value="dl.google.com">dl.google.com</option>
                                            <option value="www.apple.com">apple.com</option>
                                            <option value="www.samsung.com">samsung.com</option>
                                            <option value="www.nvidia.com">nvidia.com</option>
                                            <option value="www.amd.com">amd.com</option>
                                            <option value="steamcommunity.com">steamcommunity.com</option>
                                            <option value="www.cloudflare.com">cloudflare.com</option>
                                            <option value="www.spotify.com">spotify.com</option>
                                            <option value="gateway.icloud.com">icloud.com</option>
                                        </select>
                                    </div>
                                    <input type="text" class="form-input" id="edit-reality-sni" placeholder="www.microsoft.com" style="margin-top: 8px;">
                                </div>
                            </div>

                            <div class="form-group" style="margin-top: 15px;">
                                <label class="form-label">Private Key</label>
                                <div style="display: flex; gap: 8px;">
                                    <input type="text" class="form-input" id="edit-reality-private-key" style="flex: 1; font-family: monospace; font-size: 11px;">
                                    <button class="btn btn-primary" onclick="generateX25519Keys()" title="–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –∫–ª—é—á–∏">üîÑ X25519</button>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Public Key (–¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤)</label>
                                <div style="display: flex; gap: 8px;">
                                    <input type="text" class="form-input" id="edit-reality-public-key" readonly style="flex: 1; font-family: monospace; font-size: 11px; background: var(--bg-secondary);">
                                    <button class="btn btn-secondary" onclick="copyToClipboard(document.getElementById('edit-reality-public-key').value)" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å">üìã</button>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Short IDs</label>
                                    <div style="display: flex; gap: 8px;">
                                        <input type="text" class="form-input" id="edit-reality-short-ids" placeholder="abcd1234" style="flex: 1; font-family: monospace;">
                                        <button class="btn btn-secondary" onclick="generateShortId()" title="–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Short ID">üé≤</button>
                                    </div>
                                    <small style="color: var(--text-secondary); font-size: 11px;">–ß–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö</small>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Fingerprint</label>
                                    <select class="form-input" id="edit-reality-fingerprint">
                                        <option value="chrome">chrome</option>
                                        <option value="firefox">firefox</option>
                                        <option value="safari">safari</option>
                                        <option value="ios">ios</option>
                                        <option value="android">android</option>
                                        <option value="edge">edge</option>
                                        <option value="randomized">randomized</option>
                                        <option value="random">random</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Spider X</label>
                                <input type="text" class="form-input" id="edit-reality-spider-x" placeholder="/">
                            </div>
                        </div>

                        <!-- TLS Settings -->
                        <div id="security-tls-settings" style="display: none; background: var(--bg-tertiary); padding: 15px; border-radius: 8px; margin-top: 15px;">
                            <h4 style="margin: 0 0 15px 0; color: #27ae60;">üîí TLS Settings</h4>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Server Name</label>
                                    <input type="text" class="form-input" id="edit-tls-server-name" placeholder="example.com">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">uTLS Fingerprint</label>
                                    <select class="form-input" id="edit-tls-fingerprint">
                                        <option value="">-- –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å --</option>
                                        <option value="chrome" selected>chrome</option>
                                        <option value="firefox">firefox</option>
                                        <option value="safari">safari</option>
                                        <option value="ios">ios</option>
                                        <option value="android">android</option>
                                        <option value="edge">edge</option>
                                        <option value="360">360</option>
                                        <option value="qq">qq</option>
                                        <option value="randomized">randomized</option>
                                        <option value="random">random</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">ALPN</label>
                                    <select class="form-input" id="edit-tls-alpn" multiple style="height: 60px;">
                                        <option value="h2" selected>h2</option>
                                        <option value="http/1.1" selected>http/1.1</option>
                                        <option value="h3">h3</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Min/Max Version</label>
                                    <div style="display: flex; gap: 8px;">
                                        <select class="form-input" id="edit-tls-min-version" style="flex: 1;">
                                            <option value="">Auto</option>
                                            <option value="1.2">TLS 1.2</option>
                                            <option value="1.3">TLS 1.3</option>
                                        </select>
                                        <select class="form-input" id="edit-tls-max-version" style="flex: 1;">
                                            <option value="">Auto</option>
                                            <option value="1.2">TLS 1.2</option>
                                            <option value="1.3">TLS 1.3</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Cert File Path</label>
                                    <input type="text" class="form-input" id="edit-tls-cert-file" placeholder="/etc/letsencrypt/live/domain/fullchain.pem">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Key File Path</label>
                                    <input type="text" class="form-input" id="edit-tls-key-file" placeholder="/etc/letsencrypt/live/domain/privkey.pem">
                                </div>
                            </div>

                            <div style="margin-top: 10px; padding: 10px; background: var(--bg-secondary); border-radius: 6px;">
                                <small style="color: var(--text-secondary);">
                                    üí° <strong>uTLS Fingerprint</strong> –º–∞—Å–∫–∏—Ä—É–µ—Ç TLS –æ—Ç–ø–µ—á–∞—Ç–æ–∫ –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ–¥ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã –¥–ª—è –æ–±—Ö–æ–¥–∞ DPI.
                                    –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è <code>chrome</code> –∏–ª–∏ <code>randomized</code>.
                                </small>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: Presets -->
                    <div class="modal-tab-content" id="inbound-tab-presets" style="padding: 20px; display: none;">
                        <div style="margin-bottom: 15px; padding: 10px; background: var(--bg-secondary); border-radius: 8px;">
                            <p style="margin: 0; color: var(--text-secondary); font-size: 13px;">
                                üì¶ –í—ã–±–µ—Ä–∏—Ç–µ —à–∞–±–ª–æ–Ω –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ –∏–∑–º–µ–Ω–∏—Ç —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.
                            </p>
                        </div>

                        <div id="preset-templates-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px;">
                            <!-- VLESS + Reality -->
                            <div class="preset-card" onclick="applyPresetToInbound('vless_reality')" style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <span style="font-size: 24px;">üé≠</span>
                                    <div>
                                        <div style="font-weight: 600; color: var(--text-primary);">VLESS + Reality</div>
                                        <div style="font-size: 11px; color: #9b59b6;">TCP ‚Ä¢ Reality</div>
                                    </div>
                                </div>
                                <p style="font-size: 12px; color: var(--text-secondary); margin: 0;">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π. –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥ HTTPS —Å–∞–π—Ç.</p>
                            </div>

                            <!-- VLESS + WS + TLS -->
                            <div class="preset-card" onclick="applyPresetToInbound('vless_ws_tls')" style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <span style="font-size: 24px;">üîå</span>
                                    <div>
                                        <div style="font-weight: 600; color: var(--text-primary);">VLESS + WebSocket + TLS</div>
                                        <div style="font-size: 11px; color: #27ae60;">WebSocket ‚Ä¢ TLS</div>
                                    </div>
                                </div>
                                <p style="font-size: 12px; color: var(--text-secondary); margin: 0;">–î–ª—è CDN (Cloudflare). –¢—Ä–µ–±—É–µ—Ç –¥–æ–º–µ–Ω.</p>
                            </div>

                            <!-- VMess + WS + TLS -->
                            <div class="preset-card" onclick="applyPresetToInbound('vmess_ws_tls')" style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <span style="font-size: 24px;">üì°</span>
                                    <div>
                                        <div style="font-weight: 600; color: var(--text-primary);">VMess + WebSocket + TLS</div>
                                        <div style="font-size: 11px; color: #3498db;">WebSocket ‚Ä¢ TLS</div>
                                    </div>
                                </div>
                                <p style="font-size: 12px; color: var(--text-secondary); margin: 0;">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π CDN –ø—Ä–æ—Ç–æ–∫–æ–ª.</p>
                            </div>

                            <!-- Trojan + TLS -->
                            <div class="preset-card" onclick="applyPresetToInbound('trojan_tls')" style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <span style="font-size: 24px;">üê¥</span>
                                    <div>
                                        <div style="font-weight: 600; color: var(--text-primary);">Trojan + TLS</div>
                                        <div style="font-size: 11px; color: #e74c3c;">TCP ‚Ä¢ TLS</div>
                                    </div>
                                </div>
                                <p style="font-size: 12px; color: var(--text-secondary); margin: 0;">–ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥ HTTPS. –¢—Ä–µ–±—É–µ—Ç SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç.</p>
                            </div>

                            <!-- VLESS + gRPC -->
                            <div class="preset-card" onclick="applyPresetToInbound('vless_grpc')" style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <span style="font-size: 24px;">‚ö°</span>
                                    <div>
                                        <div style="font-weight: 600; color: var(--text-primary);">VLESS + gRPC + TLS</div>
                                        <div style="font-size: 11px; color: #f39c12;">gRPC ‚Ä¢ TLS</div>
                                    </div>
                                </div>
                                <p style="font-size: 12px; color: var(--text-secondary); margin: 0;">–ë—ã—Å—Ç—Ä—ã–π –º—É–ª—å—Ç–∏–ø–ª–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç.</p>
                            </div>

                            <!-- Shadowsocks -->
                            <div class="preset-card" onclick="applyPresetToInbound('shadowsocks')" style="background: var(--bg-tertiary); padding: 15px; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <span style="font-size: 24px;">üåë</span>
                                    <div>
                                        <div style="font-weight: 600; color: var(--text-primary);">Shadowsocks 2022</div>
                                        <div style="font-size: 11px; color: #95a5a6;">TCP ‚Ä¢ None</div>
                                    </div>
                                </div>
                                <p style="font-size: 12px; color: var(--text-secondary); margin: 0;">–ü—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π. AEAD —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ.</p>
                            </div>
                        </div>

                        <div style="margin-top: 20px; padding: 15px; background: var(--bg-secondary); border-radius: 8px;">
                            <h4 style="margin: 0 0 10px 0; font-size: 14px;">–ë—ã—Å—Ç—Ä—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:</h4>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <button class="btn btn-secondary" onclick="generateX25519Keys()" style="font-size: 12px;">üîÑ –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å X25519</button>
                                <button class="btn btn-secondary" onclick="generateShortId()" style="font-size: 12px;">üé≤ Short ID</button>
                                <button class="btn btn-secondary" onclick="generateRandomPort()" style="font-size: 12px;">üé≤ –ü–æ—Ä—Ç</button>
                                <button class="btn btn-secondary" onclick="generateRandomPath()" style="font-size: 12px;">üé≤ Path</button>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: Advanced (Raw JSON) -->
                    <div class="modal-tab-content" id="inbound-tab-advanced" style="padding: 20px; display: none;">
                        <div style="background: #fff3cd; color: #856404; padding: 10px 15px; border-radius: 8px; margin-bottom: 15px;">
                            ‚ö†Ô∏è <strong>–í–Ω–∏–º–∞–Ω–∏–µ:</strong> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ JSON –Ω–∞–ø—Ä—è–º—É—é. –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–¥–µ—Å—å –ø–µ—Ä–µ–∑–∞–ø–∏—à—É—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
                        </div>

                        <div class="form-group">
                            <label class="form-label">Stream Settings (JSON)</label>
                            <textarea class="form-input" id="edit-inbound-stream" rows="10" style="font-family: monospace; font-size: 12px;"></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Settings (JSON)</label>
                            <textarea class="form-input" id="edit-inbound-settings" rows="8" style="font-family: monospace; font-size: 12px;"></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Sniffing (JSON)</label>
                            <textarea class="form-input" id="edit-inbound-sniffing" rows="4" style="font-family: monospace; font-size: 12px;"></textarea>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="display: flex; justify-content: space-between;">
                    <div>
                        <button class="btn btn-secondary" onclick="resetInboundForm()" title="–°–±—Ä–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è">üîÑ –°–±—Ä–æ—Å–∏—Ç—å</button>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-secondary" onclick="closeInboundModal()">–û—Ç–º–µ–Ω–∞</button>
                        <button class="btn btn-primary" onclick="saveInbound()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab: X-UI Control -->
        <div id="tab-panel" class="tab-content">
            <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–Ω–µ–ª—å—é 3x-ui</h2>
            <p style="color: var(--text-secondary); margin-bottom: 20px; font-size: 14px;">
                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±–æ–π, —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –ª–æ–≥–∏ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
            </p>

            <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); margin-bottom: 30px;">
                <div class="stat-card">
                    <div class="stat-label">–°—Ç–∞—Ç—É—Å X-UI</div>
                    <div class="stat-value" id="xui-service-status" style="font-size: 16px;">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–í–µ—Ä—Å–∏—è X-UI</div>
                    <div class="stat-value" id="xui-version" style="font-size: 14px;">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–í–µ—Ä—Å–∏—è Xray</div>
                    <div class="stat-value" id="xray-version" style="font-size: 14px;">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π</div>
                    <div class="stat-value" id="tcp-connections" style="font-size: 16px;">-</div>
                </div>
            </div>

            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±–æ–π</h3>
                <div class="btn-group" style="flex-wrap: wrap;">
                    <button class="btn btn-success" onclick="xuiAction('restart')">üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å</button>
                    <button class="btn btn-warning" onclick="xuiAction('stop')">‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
                    <button class="btn btn-primary" onclick="xuiAction('start')">‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
                    <button class="btn btn-secondary" onclick="loadXuiStatus()">üìä –û–±–Ω–æ–≤–∏—Ç—å</button>
                    <button class="btn btn-primary" onclick="openPanel()" id="panel-link-btn">üîó –ü–∞–Ω–µ–ª—å</button>
                </div>

                <!-- Panel Credentials Display -->
                <div id="panel-credentials-box" style="margin-top: 15px; padding: 15px; background: var(--bg-tertiary); border-radius: 8px; border: 1px solid var(--border); display: none;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <span style="font-weight: 600; color: var(--text-primary);">üîê –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –ø–∞–Ω–µ–ª—å</span>
                        <button class="btn btn-secondary" onclick="toggleCredentialsVisibility()" style="padding: 4px 8px; font-size: 12px;" id="toggle-creds-btn">üëÅÔ∏è –ü–æ–∫–∞–∑–∞—Ç—å</button>
                    </div>
                    <div id="panel-creds-content" style="display: none;">
                        <div style="display: grid; grid-template-columns: auto 1fr auto; gap: 10px; align-items: center; font-size: 13px;">
                            <span style="color: var(--text-secondary);">–õ–æ–≥–∏–Ω:</span>
                            <code id="panel-username" style="background: var(--bg-primary); padding: 4px 8px; border-radius: 4px;">-</code>
                            <button class="btn" onclick="copyToClipboard(document.getElementById('panel-username').textContent)" style="padding: 4px 8px; font-size: 11px;">üìã</button>

                            <span style="color: var(--text-secondary);">–ü–∞—Ä–æ–ª—å:</span>
                            <code id="panel-password" style="background: var(--bg-primary); padding: 4px 8px; border-radius: 4px;">-</code>
                            <button class="btn" onclick="copyToClipboard(document.getElementById('panel-password').textContent)" style="padding: 4px 8px; font-size: 11px;">üìã</button>

                            <span style="color: var(--text-secondary);">–ü–æ—Ä—Ç:</span>
                            <code id="panel-port" style="background: var(--bg-primary); padding: 4px 8px; border-radius: 4px;">-</code>
                            <span></span>
                        </div>
                        <div style="margin-top: 12px; display: flex; gap: 10px;">
                            <button class="btn btn-warning" onclick="showResetCredentialsModal()" style="font-size: 12px;">üîÑ –°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
                            <button class="btn btn-secondary" onclick="loadPanelCredentials()" style="font-size: 12px;">üîÉ –û–±–Ω–æ–≤–∏—Ç—å</button>
                        </div>
                    </div>
                </div>
            </div>

            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h3>
                <div class="btn-group" style="flex-wrap: wrap; margin-bottom: 15px;">
                    <button class="btn btn-primary" onclick="runSpeedtest()">üöÄ Speedtest</button>
                    <button class="btn btn-warning" onclick="regenerateKeys()">üîë –ù–æ–≤—ã–µ –∫–ª—é—á–∏</button>
                    <button class="btn btn-success" onclick="applySNI()">üì° –ü—Ä–∏–º–µ–Ω–∏—Ç—å SNI</button>
                </div>
                <div id="speedtest-result" style="font-size: 12px; color: var(--text-secondary);"></div>
            </div>

            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">–õ–æ–≥–∏ X-UI</h3>
                <div class="btn-group" style="margin-bottom: 15px;">
                    <button class="btn btn-primary" onclick="loadXuiLogs('info')">üìÑ –û—Å–Ω–æ–≤–Ω—ã–µ –ª–æ–≥–∏</button>
                    <button class="btn btn-danger" onclick="loadXuiLogs('error')">‚ùå –û—à–∏–±–∫–∏</button>
                    <button class="btn btn-secondary" onclick="clearXuiLogs()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                </div>
                <pre id="xui-logs" style="background: var(--bg-primary); padding: 15px; border-radius: 8px; max-height: 300px; overflow-y: auto; font-size: 12px; white-space: pre-wrap; word-break: break-all;">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ–≤...</pre>
            </div>

            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</h3>
                <div class="btn-group" style="flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="updateDatFiles()">üåç –û–±–Ω–æ–≤–∏—Ç—å GeoIP/GeoSite</button>
                    <button class="btn btn-warning" onclick="updateXray()">‚¨ÜÔ∏è –û–±–Ω–æ–≤–∏—Ç—å Xray</button>
                </div>
                <p style="color: #888; font-size: 12px; margin-top: 15px; margin-bottom: 0;">
                    GeoIP/GeoSite - –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º (–†–æ—Å—Å–∏—è, –ò—Ä–∞–Ω –∏ –¥—Ä.)
                </p>
            </div>

            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px;">
                <h3 style="margin-top: 0;">Fingerprint (TLS/Reality)</h3>
                <p style="color: #888; font-size: 12px; margin-bottom: 15px;">
                    –û–±–Ω–æ–≤–∏—Ç—å fingerprint –Ω–∞ –≤—Å–µ—Ö inbounds —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π TLS/Reality
                </p>
                <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
                    <select id="fingerprint-select" style="padding: 10px; border-radius: 6px; border: 1px solid var(--border); background: var(--bg-primary); color: var(--text-primary); min-width: 150px;">
                        <option value="randomized">randomized</option>
                        <option value="random">random</option>
                        <option value="chrome">chrome</option>
                        <option value="firefox">firefox</option>
                        <option value="safari">safari</option>
                        <option value="ios">ios</option>
                        <option value="android">android</option>
                        <option value="edge">edge</option>
                        <option value="360">360</option>
                        <option value="qq">qq</option>
                    </select>
                    <button class="btn btn-primary" onclick="updateFingerprints()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ</button>
                    <button class="btn btn-secondary" onclick="loadFingerprints()">üìã –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–µ</button>
                </div>
                <div id="fingerprint-info" style="margin-top: 15px; font-size: 12px; color: var(--text-secondary);"></div>
            </div>
        </div>

        <!-- Tab: System Optimization -->
        <div id="tab-system" class="tab-content">
            <h2>üñ•Ô∏è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã</h2>
            <p style="color: #666; margin-bottom: 20px; font-size: 14px;">
                –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π —Å–µ—Ä–≤–µ—Ä–∞
            </p>

            <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); margin-bottom: 30px;">
                <div class="stat-card">
                    <div class="stat-label">BBR</div>
                    <div class="stat-value" id="bbr-status" style="font-size: 16px;">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">TCP Optimization</div>
                    <div class="stat-value" id="tcp-status" style="font-size: 16px;">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Kernel</div>
                    <div class="stat-value" id="kernel-version" style="font-size: 14px;">-</div>
                </div>
            </div>

            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π</h3>
                <div class="btn-group" style="margin-bottom: 15px;">
                    <button class="btn btn-primary" onclick="checkSystemOptimization()">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É</button>
                </div>
                <div id="system-check-results" style="font-family: monospace; font-size: 13px; color: var(--text-secondary);">
                    –ù–∞–∂–º–∏—Ç–µ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É" –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
                </div>
            </div>

            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px;">
                <h3 style="margin-top: 0;">–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π</h3>
                <div class="btn-group" style="flex-wrap: wrap;">
                    <button class="btn btn-success" onclick="installBBR()">üöÄ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å BBR3</button>
                    <button class="btn btn-primary" onclick="optimizeTCP()">‚ö° –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å TCP</button>
                    <button class="btn btn-warning" onclick="installAllOptimizations()">üîß –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å—ë</button>
                </div>
                <p style="color: #888; font-size: 12px; margin-top: 15px; margin-bottom: 0;">
                    ‚ö†Ô∏è BBR3 —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
                </p>
            </div>

            <!-- Update Server Management -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-top: 20px;">
                <h3 style="margin-top: 0;">üîÑ –¶–µ–Ω—Ç—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π</h3>
                <p style="color: #666; font-size: 13px; margin-bottom: 15px;">
                    –û—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –∞–≥–µ–Ω—Ç–∞ (–ø–æ—Ä—Ç 8889)
                </p>

                <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); margin-bottom: 15px;">
                    <div class="stat-card">
                        <div class="stat-label">–°—Ç–∞—Ç—É—Å</div>
                        <div class="stat-value" id="update-server-status" style="font-size: 14px;">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</div>
                        <div class="stat-value" id="update-server-installed" style="font-size: 14px;">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">–ü–æ—Ä—Ç</div>
                        <div class="stat-value" id="update-server-port" style="font-size: 14px;">8889</div>
                    </div>
                </div>

                <div class="btn-group" style="flex-wrap: wrap; margin-bottom: 15px;">
                    <button class="btn btn-primary" onclick="checkUpdateServer()">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                    <button class="btn btn-success" onclick="installUpdateServer()" id="btn-install-update-server">üì¶ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
                    <button class="btn btn-primary" onclick="controlUpdateServer('start')" id="btn-start-update-server">‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
                    <button class="btn btn-warning" onclick="controlUpdateServer('restart')" id="btn-restart-update-server">üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å</button>
                    <button class="btn btn-danger" onclick="controlUpdateServer('stop')" id="btn-stop-update-server">‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
                </div>

                <div id="update-server-logs" style="font-family: monospace; font-size: 12px; color: var(--text-secondary); max-height: 150px; overflow-y: auto; background: var(--bg-tertiary); padding: 10px; border-radius: 6px; display: none;">
                </div>
            </div>
        </div>

        <!-- Tab: Automation Settings -->
        <div id="tab-automation" class="tab-content">
            <h2>ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è</h2>
            <p style="color: var(--text-secondary); margin-bottom: 20px; font-size: 14px;">
                –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
            </p>

            <!-- Services Status -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">üìä –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤</h3>
                <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));" id="services-status-grid">
                    <div class="stat-card">
                        <div class="stat-label">X-UI</div>
                        <div class="stat-value" id="service-xui-status" style="font-size: 14px;">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">XUI-Manager</div>
                        <div class="stat-value" id="service-manager-status" style="font-size: 14px;">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Nginx</div>
                        <div class="stat-value" id="service-nginx-status" style="font-size: 14px;">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">WARP</div>
                        <div class="stat-value" id="service-warp-status" style="font-size: 14px;">-</div>
                    </div>
                </div>
                <div class="btn-group" style="margin-top: 15px;">
                    <button class="btn btn-primary" onclick="loadServicesStatus()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                    <button class="btn btn-warning" onclick="restartService('x-ui')">üîÑ X-UI</button>
                    <button class="btn btn-warning" onclick="restartService('nginx')">üîÑ Nginx</button>
                </div>
            </div>

            <!-- Backup Settings -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">üíæ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±—ç–∫–∞–ø–æ–≤</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="backup-enabled" checked>
                            <span>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã</span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label class="form-label">–ò–Ω—Ç–µ—Ä–≤–∞–ª (—á–∞—Å–æ–≤)</label>
                        <input type="number" class="form-input" id="backup-interval" value="24" min="1" max="168">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–•—Ä–∞–Ω–∏—Ç—å (–¥–Ω–µ–π)</label>
                        <input type="number" class="form-input" id="backup-retention" value="7" min="1" max="30">
                    </div>
                </div>
            </div>

            <!-- SSL Settings -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">üîê SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã</h3>
                <div id="ssl-certificates-list" style="margin-bottom: 15px;">
                    <p style="color: var(--text-secondary);">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="ssl-auto-check" checked>
                            <span>–ê–≤—Ç–æ-–ø—Ä–æ–≤–µ—Ä–∫–∞ SSL</span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="ssl-auto-renew" checked>
                            <span>–ê–≤—Ç–æ-–ø—Ä–æ–¥–ª–µ–Ω–∏–µ</span>
                        </label>
                    </div>
                </div>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="checkSSLCertificates()">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSL</button>
                    <button class="btn btn-success" onclick="renewSSLCertificates()">üîÑ –ü—Ä–æ–¥–ª–∏—Ç—å</button>
                </div>
            </div>

            <!-- WARP Settings -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">üåê Cloudflare WARP</h3>
                <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); margin-bottom: 15px;">
                    <div class="stat-card">
                        <div class="stat-label">–°—Ç–∞—Ç—É—Å</div>
                        <div class="stat-value" id="warp-connection-status" style="font-size: 14px;">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">IP</div>
                        <div class="stat-value" id="warp-ip" style="font-size: 12px;">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">–°—Ç—Ä–∞–Ω–∞</div>
                        <div class="stat-value" id="warp-country" style="font-size: 14px;">-</div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="warp-health-check">
                            <span>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è</span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="warp-auto-restart">
                            <span>–ê–≤—Ç–æ-–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫</span>
                        </label>
                    </div>
                </div>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="checkWarpStatus()">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                    <button class="btn btn-warning" onclick="restartWarp()">üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å</button>
                </div>
            </div>

            <!-- Save Button -->
            <div style="text-align: right; margin-top: 20px;">
                <button class="btn btn-success" onclick="saveAutomationSettings()" style="padding: 12px 30px;">
                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                </button>
            </div>
        </div>

        <!-- Tab: Backups -->
        <div id="tab-backups" class="tab-content">
            <h2>üíæ –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏</h2>
            <p style="color: var(--text-secondary); margin-bottom: 20px; font-size: 14px;">
                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—ç–∫–∞–ø–∞–º–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            </p>

            <div class="btn-group" style="margin-bottom: 20px;">
                <button class="btn btn-success" onclick="createBackup()">‚ûï –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø</button>
                <button class="btn btn-primary" onclick="loadBackups()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>–î–∞—Ç–∞</th>
                            <th>–§–∞–π–ª–æ–≤</th>
                            <th>–†–∞–∑–º–µ—Ä</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="backups-table-body">
                        <tr><td colspan="4" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr>
                    </tbody>
                </table>
            </div>

            <div style="background: var(--bg-secondary); padding: 15px; border-radius: 8px; margin-top: 20px;">
                <h4 style="margin: 0 0 10px 0;">‚ÑπÔ∏è –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ –≤ –±—ç–∫–∞–ø:</h4>
                <ul style="margin: 0; padding-left: 20px; color: var(--text-secondary); font-size: 13px;">
                    <li>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö x-ui.db (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, inbounds)</li>
                    <li>–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Xray (config.json)</li>
                    <li>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ XUI-Manager (.env)</li>
                </ul>
            </div>
        </div>

        <!-- Tab: Monitoring -->
        <div id="tab-monitoring" class="tab-content">
            <h2>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–µ—Ä–∞</h2>
            <p style="color: #666; margin-bottom: 20px; font-size: 14px;">
                –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö
            </p>

            <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); margin-bottom: 30px;">
                <div class="stat-card">
                    <div class="stat-label">–û–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                    <div class="stat-value" id="online-users-count" style="color: var(--success)">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–ó–∞–≥—Ä—É–∑–∫–∞ CPU</div>
                    <div class="stat-value" id="cpu-usage">-</div>
                    <div style="background: var(--bg-primary); height: 6px; border-radius: 3px; margin-top: 8px; overflow: hidden;">
                        <div id="cpu-bar" style="background: var(--accent); height: 100%; width: 0%; transition: width 0.3s;"></div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–ü–∞–º—è—Ç—å</div>
                    <div class="stat-value" id="memory-usage">-</div>
                    <div style="background: var(--bg-primary); height: 6px; border-radius: 3px; margin-top: 8px; overflow: hidden;">
                        <div id="memory-bar" style="background: var(--success); height: 100%; width: 0%; transition: width 0.3s;"></div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–î–∏—Å–∫</div>
                    <div class="stat-value" id="disk-usage">-</div>
                    <div style="background: var(--bg-primary); height: 6px; border-radius: 3px; margin-top: 8px; overflow: hidden;">
                        <div id="disk-bar" style="background: var(--warning); height: 100%; width: 0%; transition: width 0.3s;"></div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–°–µ—Ç—å (–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ)</div>
                    <div class="stat-value" id="network-sent" style="font-size: 20px;">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–°–µ—Ç—å (–ø–æ–ª—É—á–µ–Ω–æ)</div>
                    <div class="stat-value" id="network-recv" style="font-size: 20px;">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã</div>
                    <div class="stat-value" id="server-uptime" style="font-size: 20px;">-</div>
                </div>
            </div>

            <div style="text-align: center; color: #666; font-size: 13px;">
                –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
            </div>
        </div>

        <!-- Tab: API Tokens -->
        <div id="tab-api-tokens" class="tab-content">
            <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API –¢–æ–∫–µ–Ω–∞–º–∏</h2>
            <p style="color: #666; margin-bottom: 20px; font-size: 14px;">
                –°–æ–∑–¥–∞–≤–∞–π—Ç–µ API —Ç–æ–∫–µ–Ω—ã –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ API. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫: <code>Authorization: Bearer &lt;token&gt;</code>
            </p>

            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞</label>
                    <input type="text" class="form-input" id="token-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Production Server">
                </div>
                <div class="form-group" style="display: flex; align-items: flex-end;">
                    <button class="btn btn-primary" onclick="generateToken()">üîë –°–æ–∑–¥–∞—Ç—å —Ç–æ–∫–µ–Ω</button>
                </div>
            </div>

            <!-- Token display modal -->
            <div id="token-display" style="display: none; margin: 20px 0; padding: 20px; background: #e8f4fd; border-left: 4px solid #0066cc; border-radius: 4px;">
                <strong>‚úÖ –¢–æ–∫–µ–Ω —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!</strong>
                <p style="margin: 10px 0; color: #c33;">‚ö†Ô∏è –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ. –û–Ω –±–æ–ª—å—à–µ –Ω–µ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω!</p>
                <div style="background: white; padding: 12px; border-radius: 4px; margin: 10px 0; font-family: monospace; word-break: break-all;">
                    <span id="new-token-value"></span>
                </div>
                <button class="btn btn-secondary" onclick="copyToken()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                <button class="btn btn-success" onclick="closeTokenDisplay()">‚úÖ –ü–æ–Ω—è—Ç–Ω–æ, —Å–æ—Ö—Ä–∞–Ω–∏–ª</button>
            </div>

            <h3 style="margin-top: 30px;">–ê–∫—Ç–∏–≤–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                            <th>–¢–æ–∫–µ–Ω (–Ω–∞—á–∞–ª–æ)</th>
                            <th>–°–æ–∑–¥–∞–Ω</th>
                            <th>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="tokens-table-body">
                        <tr><td colspan="6" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Tab: Panel Management -->
        <div id="tab-panel-manage" class="tab-content">
            <h2>üîê –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–Ω–µ–ª—å—é 3x-ui</h2>
            <p style="color: #666; margin-bottom: 20px; font-size: 14px;">
                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á—ë—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∏ —Ä–µ–∑–µ—Ä–≤–Ω—ã–º–∏ –∫–æ–ø–∏—è–º–∏ –ø–∞–Ω–µ–ª–∏ 3x-ui
            </p>

            <!-- Panel Status -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">üìä –°—Ç–∞—Ç—É—Å –ø–∞–Ω–µ–ª–∏</h3>
                <div id="panel-status-info" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 15px;">
                    <div class="stat-card">
                        <div class="stat-label">–°—Ç–∞—Ç—É—Å</div>
                        <div class="stat-value" id="pm-status" style="font-size: 16px;">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">–í–µ—Ä—Å–∏—è</div>
                        <div class="stat-value" id="pm-version" style="font-size: 14px;">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Xray</div>
                        <div class="stat-value" id="pm-xray" style="font-size: 14px;">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                        <div class="stat-value" id="pm-users" style="font-size: 16px;">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Inbounds</div>
                        <div class="stat-value" id="pm-inbounds" style="font-size: 16px;">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">–†–∞–∑–º–µ—Ä –ë–î</div>
                        <div class="stat-value" id="pm-dbsize" style="font-size: 14px;">-</div>
                    </div>
                </div>
                <button class="btn btn-secondary" onclick="loadPanelStatus()" style="margin-top: 15px;">üîÉ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å</button>
            </div>

            <!-- Credentials Management -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">üîë –£—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                    <div class="form-group">
                        <label class="form-label">–ù–æ–≤—ã–π –ª–æ–≥–∏–Ω</label>
                        <input type="text" class="form-input" id="new-panel-username" placeholder="admin" value="admin">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                        <input type="text" class="form-input" id="new-panel-password" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å">
                        <button class="btn btn-secondary" onclick="generateRandomPassword()" style="margin-top: 5px; font-size: 11px;">üé≤ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
                    </div>
                </div>
                <div class="btn-group" style="margin-top: 15px;">
                    <button class="btn btn-warning" onclick="resetPanelCredentials()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
                </div>
            </div>

            <!-- Database Backup/Restore -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">üíæ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
                <div class="btn-group" style="margin-bottom: 15px;">
                    <button class="btn btn-success" onclick="createPanelBackup()">üì¶ –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø</button>
                    <button class="btn btn-secondary" onclick="loadPanelBackups()">üìã –°–ø–∏—Å–æ–∫ –±—ç–∫–∞–ø–æ–≤</button>
                </div>
                <div id="panel-backups-list" style="display: none; margin-top: 15px;">
                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th>–§–∞–π–ª</th>
                                <th>–†–∞–∑–º–µ—Ä</th>
                                <th>–î–∞—Ç–∞</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="backups-tbody">
                            <tr><td colspan="4">–ù–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Panel Reinstall -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">üîß –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–Ω–µ–ª–∏</h3>
                <p style="color: #888; font-size: 12px; margin-bottom: 15px;">
                    –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–Ω–µ–ª–∏ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                </p>
                <div class="form-group" style="margin-bottom: 15px;">
                    <label class="form-label">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–∫</label>
                    <select id="panel-fork-select" class="form-input" style="max-width: 300px;">
                        <option value="mhsanaei">MHSanaei (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</option>
                        <option value="alireza">Alireza0</option>
                        <option value="franzkafka">FranzKafkaYu</option>
                    </select>
                </div>
                <div style="display: flex; gap: 15px; margin-bottom: 15px;">
                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                        <input type="checkbox" id="preserve-db" checked> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
                    </label>
                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                        <input type="checkbox" id="preserve-config" checked> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                    </label>
                </div>
                <button class="btn btn-danger" onclick="reinstallPanel()">‚ö†Ô∏è –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–Ω–µ–ª—å</button>
            </div>
        </div>

        <!-- Tab: Nginx Management -->
        <div id="tab-nginx-manage" class="tab-content">
            <h2>üåê –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Nginx</h2>
            <p style="color: #666; margin-bottom: 20px; font-size: 14px;">
                –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ nginx, –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –¥–ª—è inbounds
            </p>

            <!-- Nginx Status -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">üìä –°—Ç–∞—Ç—É—Å Nginx</h3>
                <div id="nginx-status-info" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 15px;">
                    <div class="stat-card">
                        <div class="stat-label">–°—Ç–∞—Ç—É—Å</div>
                        <div class="stat-value" id="nginx-running" style="font-size: 16px;">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</div>
                        <div class="stat-value" id="nginx-valid" style="font-size: 16px;">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">SSL</div>
                        <div class="stat-value" id="nginx-ssl" style="font-size: 16px;">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">XUI Manager</div>
                        <div class="stat-value" id="nginx-xui-manager" style="font-size: 14px;">-</div>
                    </div>
                </div>
                <div id="nginx-domains" style="margin-top: 15px; font-size: 13px; color: var(--text-secondary);"></div>
                <div class="btn-group" style="margin-top: 15px;">
                    <button class="btn btn-secondary" onclick="loadNginxStatus()">üîÉ –û–±–Ω–æ–≤–∏—Ç—å</button>
                    <button class="btn btn-primary" onclick="testNginxConfig()">üß™ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥</button>
                    <button class="btn btn-warning" onclick="reloadNginx()">üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å Nginx</button>
                </div>
            </div>

            <!-- Nginx Warnings/Errors -->
            <div id="nginx-issues" style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px; display: none;">
                <h3 style="margin-top: 0;">‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã</h3>
                <div id="nginx-errors" style="color: var(--danger); margin-bottom: 10px;"></div>
                <div id="nginx-warnings" style="color: var(--warning);"></div>
            </div>

            <!-- Inbound Requirements -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">üì° –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è Inbounds –∫ Nginx</h3>
                <p style="color: #888; font-size: 12px; margin-bottom: 15px;">
                    –ê–Ω–∞–ª–∏–∑ inbounds, –∫–æ—Ç–æ—Ä—ã–º —Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è nginx (WebSocket, gRPC, HTTP Upgrade)
                </p>
                <button class="btn btn-primary" onclick="analyzeInboundRequirements()">üîç –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button>
                <div id="inbound-requirements" style="margin-top: 15px; display: none;">
                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th>Inbound</th>
                                <th>–¢–∏–ø</th>
                                <th>–ü–æ—Ä—Ç</th>
                                <th>–¢—Ä–µ–±—É–µ—Ç Nginx</th>
                                <th>–ü—Ä–∏—á–∏–Ω–∞</th>
                            </tr>
                        </thead>
                        <tbody id="inbound-req-tbody"></tbody>
                    </table>
                </div>
                <div id="suggested-nginx-config" style="margin-top: 15px; display: none;">
                    <h4>–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:</h4>
                    <pre id="suggested-config-content" style="background: var(--bg-primary); padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 12px;"></pre>
                    <button class="btn btn-secondary" onclick="copySuggestedConfig()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
            </div>

            <!-- Nginx Config Viewer -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px;">
                <h3 style="margin-top: 0;">üìÑ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx</h3>
                <div class="btn-group" style="margin-bottom: 15px;">
                    <button class="btn btn-secondary" onclick="loadNginxConfig()">üìÑ –ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥</button>
                </div>
                <pre id="nginx-config-content" style="background: var(--bg-primary); padding: 15px; border-radius: 8px; max-height: 400px; overflow: auto; font-size: 12px; display: none;"></pre>
            </div>
        </div>

        <!-- Tab: Camouflage -->
        <div id="tab-camouflage" class="tab-content">
            <h2>üé≠ –ö–∞–º—É—Ñ–ª—è–∂ - Fake —Å–∞–π—Ç—ã</h2>
            <p style="color: #666; margin-bottom: 20px; font-size: 14px;">
                –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–µ–π–∫–æ–≤—ã—Ö —Å–∞–π—Ç–æ–≤ –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ VPN-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
            </p>

            <!-- Current Site Status -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å</h3>
                <div id="camouflage-status" style="margin-top: 15px;">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                        <span style="color: var(--text-secondary);">–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:</span>
                        <span id="camo-installed" style="font-weight: 600;">-</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="color: var(--text-secondary);">–®–∞–±–ª–æ–Ω:</span>
                        <span id="camo-template-name">-</span>
                    </div>
                </div>
                <div class="btn-group" style="margin-top: 15px;">
                    <button class="btn btn-secondary" onclick="loadCamouflageStatus()">üîÉ –û–±–Ω–æ–≤–∏—Ç—å</button>
                    <button class="btn btn-danger" onclick="removeCamouflage()">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å fake —Å–∞–π—Ç</button>
                </div>
            </div>

            <!-- Template Gallery -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="margin-top: 0;">üé® –ì–∞–ª–µ—Ä–µ—è —à–∞–±–ª–æ–Ω–æ–≤</h3>
                <div class="btn-group" style="margin-bottom: 15px;">
                    <button class="btn btn-primary" onclick="loadCamouflageTemplates()">üìã –ó–∞–≥—Ä—É–∑–∏—Ç—å —à–∞–±–ª–æ–Ω—ã</button>
                    <button class="btn btn-success" onclick="installRandomTemplate()">üé≤ –°–ª—É—á–∞–π–Ω—ã–π —à–∞–±–ª–æ–Ω</button>
                </div>

                <div id="templates-filter" style="margin-bottom: 15px; display: none;">
                    <label class="form-label">–§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:</label>
                    <select id="template-category-filter" class="form-input" style="max-width: 200px;" onchange="filterTemplates()">
                        <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                    </select>
                </div>

                <div id="templates-gallery" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px;"></div>
            </div>

            <!-- Custom HTML -->
            <div style="background: var(--bg-secondary); padding: 20px; border-radius: 8px;">
                <h3 style="margin-top: 0;">‚úèÔ∏è –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π HTML</h3>
                <p style="color: #888; font-size: 12px; margin-bottom: 15px;">
                    –í—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ–π HTML –∫–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ fake —Å–∞–π—Ç–∞
                </p>
                <div class="form-group">
                    <textarea id="custom-html-input" class="form-input" style="min-height: 200px; font-family: monospace;" placeholder="<!DOCTYPE html>
<html>
<head><title>My Site</title></head>
<body>...</body>
</html>"></textarea>
                </div>
                <button class="btn btn-primary" onclick="installCustomHtml()">üì• –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å HTML</button>
            </div>
        </div>

            </div><!-- Close main-content -->
        </div><!-- Close app-layout -->
    </div>

    <!-- Footer with Version and Update Button -->
    <footer style="
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: var(--bg-secondary);
        border-top: 1px solid var(--border);
        color: var(--text-primary);
        padding: 8px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        z-index: 1000;
        font-size: 13px;
    ">
        <div style="display: flex; align-items: center; gap: 15px;">
            <span id="version-info">‚öôÔ∏è –ó–∞–≥—Ä—É–∑–∫–∞ –≤–µ—Ä—Å–∏–∏...</span>
        </div>
        <div id="update-buttons" style="display: none; align-items: center; gap: 10px;">
            <span id="update-status" style="color: var(--success); font-size: 12px;"></span>
            <button id="perform-update-btn" onclick="performUpdate()" style="
                background: var(--success);
                border: none;
                color: white;
                padding: 5px 12px;
                border-radius: 4px;
                cursor: pointer;
                font-size: 12px;
                font-weight: 600;
                transition: all 0.3s;
            ">
                ‚¨ÜÔ∏è –û–±–Ω–æ–≤–∏—Ç—å –¥–æ <span id="new-version"></span>
            </button>
        </div>
    </footer>


    <script src="static/js/main.js"></script>
</body>
</html>
